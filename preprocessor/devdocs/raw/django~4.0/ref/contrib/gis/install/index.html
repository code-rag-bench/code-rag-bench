<h1 id="geodjango-installation">GeoDjango Installation</h1>  <h2 id="overview">Overview</h2> <p id="s-geodjango-installation">In general, GeoDjango installation requires:</p> <ol class="arabic simple"> <li><a class="reference internal" href="#django"><span class="std std-ref">Python and Django</span></a></li> <li><a class="reference internal" href="#spatial-database"><span class="std std-ref">Spatial database</span></a></li> <li><a class="reference internal" href="geolibs"><span class="doc">Installing Geospatial libraries</span></a></li> </ol> <p>Details for each of the requirements and installation instructions are provided in the sections below. In addition, platform-specific instructions are available for:</p> <ul class="simple"> <li><a class="reference internal" href="#macos"><span class="std std-ref">macOS</span></a></li> <li><a class="reference internal" href="#windows"><span class="std std-ref">Windows</span></a></li> </ul> <div class="admonition-use-the-source admonition"> <p class="first admonition-title">Use the Source</p> <p class="last">Because GeoDjango takes advantage of the latest in the open source geospatial software technology, recent versions of the libraries are necessary. If binary packages aren’t available for your platform, installation from source may be required. When compiling the libraries from source, please follow the directions closely, especially if you’re a beginner.</p> </div>   <h2 id="requirements">Requirements</h2>  <h3 id="django">Python and Django</h3> <p id="s-requirements">Because GeoDjango is included with Django, please refer to Django’s <a class="reference internal" href="../../../../topics/install#installing-official-release"><span class="std std-ref">installation instructions</span></a> for details on how to install.</p>   <h3 id="id1">Spatial database</h3> <p id="s-spatial-database">PostgreSQL (with PostGIS), MySQL, Oracle, and SQLite (with SpatiaLite) are the spatial databases currently supported.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">PostGIS is recommended, because it is the most mature and feature-rich open source spatial database.</p> </div> <p>The geospatial libraries required for a GeoDjango installation depends on the spatial database used. The following lists the library requirements, supported versions, and any notes for each of the supported database backends:</p> <table class="docutils">  <thead valign="bottom"> <tr>
<th class="head">Database</th> <th class="head">Library Requirements</th> <th class="head">Supported Versions</th> <th class="head">Notes</th> </tr> </thead>  <tr>
<td>PostgreSQL</td> <td>GEOS, GDAL, PROJ, PostGIS</td> <td>10+</td> <td>Requires PostGIS.</td> </tr> <tr>
<td>MySQL</td> <td>GEOS, GDAL</td> <td>5.7+</td> <td>
<a class="reference internal" href="../db-api#mysql-spatial-limitations"><span class="std std-ref">Limited functionality</span></a>.</td> </tr> <tr>
<td>Oracle</td> <td>GEOS, GDAL</td> <td>19+</td> <td>XE not supported.</td> </tr> <tr>
<td>SQLite</td> <td>GEOS, GDAL, PROJ, SpatiaLite</td> <td>3.9.0+</td> <td>Requires SpatiaLite 4.3+</td> </tr>  </table> <p>See also <a class="reference external" href="https://trac.osgeo.org/postgis/wiki/UsersWikiPostgreSQLPostGIS">this comparison matrix</a> on the OSGeo Wiki for PostgreSQL/PostGIS/GEOS/GDAL possible combinations.</p>    <h2 id="installation">Installation</h2>  <h3 id="geospatial-libraries">Geospatial libraries</h3>  <ul id="s-installation"> <li class="toctree-l1"><a class="reference internal" href="geolibs">Installing Geospatial libraries</a></li> </ul>    <h3 id="database-installation">Database installation</h3>  <ul id="s-database-installation"> <li class="toctree-l1"><a class="reference internal" href="postgis">Installing PostGIS</a></li> <li class="toctree-l1"><a class="reference internal" href="spatialite">Installing SpatiaLite</a></li> </ul>    <h3 id="databases-configuration">
<a class="reference internal" href="../../../settings#std:setting-DATABASES"><code>DATABASES</code></a> configuration</h3> <p id="s-databases-configuration">Set the <a class="reference internal" href="../../../settings#std:setting-DATABASE-ENGINE"><code>ENGINE</code></a> setting to one of the <a class="reference internal" href="../db-api#spatial-backends"><span class="std std-ref">spatial backends</span></a>.</p>   <h3 id="add-django-contrib-gis-to-installed-apps">Add <code>django.contrib.gis</code> to <a class="reference internal" href="../../../settings#std:setting-INSTALLED_APPS"><code>INSTALLED_APPS</code></a>
</h3> <p id="s-add-django-contrib-gis-to-installed-apps">Like other Django contrib applications, you will <em>only</em> need to add <a class="reference internal" href="../index#module-django.contrib.gis" title="django.contrib.gis: Geographic Information System (GIS) extensions for Django"><code>django.contrib.gis</code></a> to <a class="reference internal" href="../../../settings#std:setting-INSTALLED_APPS"><code>INSTALLED_APPS</code></a> in your settings. This is so that the <code>gis</code> templates can be located – if not done, then features such as the geographic admin or KML sitemaps will not function properly.</p>    <h2 id="troubleshooting">Troubleshooting</h2> <p id="s-troubleshooting">If you can’t find the solution to your problem here then participate in the community! You can:</p> <ul class="simple"> <li>Join the <code>#django-geo</code> IRC channel on Libera.Chat. Please be patient and polite – while you may not get an immediate response, someone will attempt to answer your question as soon as they see it.</li> <li>Ask your question on the <a class="reference external" href="https://forum.djangoproject.com/c/internals/geodjango/13">GeoDjango</a> forum.</li> <li>File a ticket on the <a class="reference external" href="https://code.djangoproject.com/newticket">Django trac</a> if you think there’s a bug. Make sure to provide a complete description of the problem, versions used, and specify the component as “GIS”.</li> </ul>  <h3 id="libsettings">Library environment settings</h3> <p id="s-library-environment-settings">By far, the most common problem when installing GeoDjango is that the external shared libraries (e.g., for GEOS and GDAL) cannot be located. <a class="footnote-reference" href="#id25" id="id5">[1]</a> Typically, the cause of this problem is that the operating system isn’t aware of the directory where the libraries built from source were installed.</p> <p>In general, the library path may be set on a per-user basis by setting an environment variable, or by configuring the library path for the entire system.</p>  <h4 id="ld-library-path-environment-variable">
<code>LD_LIBRARY_PATH</code> environment variable</h4> <p id="s-ld-library-path-environment-variable">A user may set this environment variable to customize the library paths they want to use. The typical library directory for software built from source is <code>/usr/local/lib</code>. Thus, <code>/usr/local/lib</code> needs to be included in the <code>LD_LIBRARY_PATH</code> variable. For example, the user could place the following in their bash profile:</p> <pre data-language="console">export LD_LIBRARY_PATH=/usr/local/lib
</pre>   <h4 id="setting-system-library-path">Setting system library path</h4> <p id="s-setting-system-library-path">On GNU/Linux systems, there is typically a file in <code>/etc/ld.so.conf</code>, which may include additional paths from files in another directory, such as <code>/etc/ld.so.conf.d</code>. As the root user, add the custom library path (like <code>/usr/local/lib</code>) on a new line in <code>ld.so.conf</code>. This is <em>one</em> example of how to do so:</p> <pre data-language="console">$ sudo echo /usr/local/lib &gt;&gt; /etc/ld.so.conf
$ sudo ldconfig
</pre> <p>For OpenSolaris users, the system library path may be modified using the <code>crle</code> utility. Run <code>crle</code> with no options to see the current configuration and use <code>crle -l</code> to set with the new library path. Be <em>very</em> careful when modifying the system library path:</p> <pre data-language="console"># crle -l $OLD_PATH:/usr/local/lib
</pre>   <h4 id="binutils">Install <code>binutils</code>
</h4> <p id="s-install-binutils">GeoDjango uses the <code>find_library</code> function (from the <code>ctypes.util</code> Python module) to discover libraries. The <code>find_library</code> routine uses a program called <code>objdump</code> (part of the <code>binutils</code> package) to verify a shared library on GNU/Linux systems. Thus, if <code>binutils</code> is not installed on your Linux system then Python’s ctypes may not be able to find your library even if your library path is set correctly and geospatial libraries were built perfectly.</p> <p>The <code>binutils</code> package may be installed on Debian and Ubuntu systems using the following command:</p> <pre data-language="console">$ sudo apt-get install binutils
</pre> <p>Similarly, on Red Hat and CentOS systems:</p> <pre data-language="console">$ sudo yum install binutils
</pre>     <h2 id="platform-specific-instructions">Platform-specific instructions</h2>  <h3 id="id6">macOS</h3> <p id="s-platform-specific-instructions">Because of the variety of packaging systems available for macOS, users have several different options for installing GeoDjango. These options are:</p> <ul class="simple"> <li>
<a class="reference internal" href="#postgresapp"><span class="std std-ref">Postgres.app</span></a> (easiest and recommended)</li> <li><a class="reference internal" href="#homebrew"><span class="std std-ref">Homebrew</span></a></li> <li><a class="reference internal" href="#kyngchaos"><span class="std std-ref">KyngChaos packages</span></a></li> <li><a class="reference internal" href="#fink"><span class="std std-ref">Fink</span></a></li> <li><a class="reference internal" href="#macports"><span class="std std-ref">MacPorts</span></a></li> <li><a class="reference internal" href="geolibs#build-from-source"><span class="std std-ref">Building from source</span></a></li> </ul> <p>This section also includes instructions for installing an upgraded version of <a class="reference internal" href="#macos-python"><span class="std std-ref">Python</span></a> from packages provided by the Python Software Foundation, however, this is not required.</p>  <h4 id="macos-python">Python</h4> <p id="s-python">Although macOS comes with Python installed, users can use <a class="reference external" href="https://www.python.org/ftp/python/">framework installers</a> provided by the Python Software Foundation. An advantage to using the installer is that macOS’s Python will remain “pristine” for internal operating system use.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p>You will need to modify the <code>PATH</code> environment variable in your <code>.profile</code> file so that the new version of Python is used when <code>python</code> is entered at the command-line:</p> <pre data-language="console">export PATH=/Library/Frameworks/Python.framework/Versions/Current/bin:$PATH
</pre> </div>   <h4 id="postgresapp">Postgres.app</h4> <p id="s-postgres-app"><a class="reference external" href="https://postgresapp.com/">Postgres.app</a> is a standalone PostgreSQL server that includes the PostGIS extension. You will also need to install <code>gdal</code> and <code>libgeoip</code> with <a class="reference internal" href="#homebrew"><span class="std std-ref">Homebrew</span></a>.</p> <p>After installing Postgres.app, add the following to your <code>.bash_profile</code> so you can run the package’s programs from the command-line. Replace <code>X.Y</code> with the version of PostgreSQL in the Postgres.app you installed:</p> <pre data-language="bash">export PATH=$PATH:/Applications/Postgres.app/Contents/Versions/X.Y/bin
</pre> <p>You can check if the path is set up correctly by typing <code>which psql</code> at a terminal prompt.</p>   <h4 id="id9">Homebrew</h4> <p id="s-homebrew"><a class="reference external" href="https://brew.sh/">Homebrew</a> provides “recipes” for building binaries and packages from source. It provides recipes for the GeoDjango prerequisites on Macintosh computers running macOS. Because Homebrew still builds the software from source, <a class="reference external" href="https://developer.apple.com/xcode/">Xcode</a> is required.</p> <p>Summary:</p> <pre data-language="console">$ brew install postgresql
$ brew install postgis
$ brew install gdal
$ brew install libgeoip
</pre>   <h4 id="kyngchaos">KyngChaos packages</h4> <p id="s-kyngchaos-packages">William Kyngesburye provides a number of <a class="reference external" href="https://www.kyngchaos.com/software/frameworks">geospatial library binary packages</a> that help to get GeoDjango installed on macOS without compiling them from source. However, <a class="reference external" href="https://developer.apple.com/xcode/">Xcode</a> is still necessary for compiling the Python database adapters <a class="reference internal" href="#psycopg2-kyngchaos"><span class="std std-ref">psycopg2</span></a> (for PostGIS).</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">SpatiaLite users should consult the <a class="reference internal" href="spatialite#spatialite-macos"><span class="std std-ref">macOS-specific instructions</span></a> section after installing the packages for additional instructions.</p> </div> <p>Download the framework packages for:</p> <ul class="simple"> <li>UnixImageIO</li> <li>PROJ</li> <li>GEOS</li> <li>SQLite3 (includes the SpatiaLite library)</li> <li>GDAL</li> </ul> <p>Install the packages in the order they are listed above, as the GDAL and SQLite packages require the packages listed before them.</p> <p>Afterward, you can also install the KyngChaos binary packages for <a class="reference external" href="https://www.kyngchaos.com/software/postgres">PostgreSQL and PostGIS</a>.</p> <p>After installing the binary packages, you’ll want to add the following to your <code>.profile</code> to be able to run the package programs from the command-line:</p> <pre data-language="console">export PATH=/Library/Frameworks/UnixImageIO.framework/Programs:$PATH
export PATH=/Library/Frameworks/PROJ.framework/Programs:$PATH
export PATH=/Library/Frameworks/GEOS.framework/Programs:$PATH
export PATH=/Library/Frameworks/SQLite3.framework/Programs:$PATH
export PATH=/Library/Frameworks/GDAL.framework/Programs:$PATH
export PATH=/usr/local/pgsql/bin:$PATH
</pre>  <h5 id="psycopg2-kyngchaos">psycopg2</h5> <p id="s-psycopg2">After you’ve installed the KyngChaos binaries and modified your <code>PATH</code>, as described above, <code>psycopg2</code> may be installed using the following command:</p> <pre data-language="console">$ python -m pip install psycopg2
</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">If you don’t have <code>pip</code>, follow the <a class="reference internal" href="../../../../topics/install#installing-official-release"><span class="std std-ref">installation instructions</span></a> to install it.</p> </div>   <h5 id="id13">Fink</h5> <p id="s-fink"><a class="reference external" href="https://schwehr.blogspot.com/">Kurt Schwehr</a> has been gracious enough to create GeoDjango packages for users of the <a class="reference external" href="https://www.finkproject.org/">Fink</a> package system. <a class="reference external" href="https://pdb.finkproject.org/pdb/browse.php?summary=django-gis">Different packages are available</a> (starting with <code>django-gis</code>), depending on which version of Python you want to use.</p>    <h4 id="id17">MacPorts</h4> <p id="s-macports"><a class="reference external" href="https://www.macports.org/">MacPorts</a> may be used to install GeoDjango prerequisites on computers running macOS. Because MacPorts still builds the software from source, <a class="reference external" href="https://developer.apple.com/xcode/">Xcode</a> is required.</p> <p>Summary:</p> <pre data-language="console">$ sudo port install postgresql13-server
$ sudo port install geos
$ sudo port install proj6
$ sudo port install postgis3
$ sudo port install gdal
$ sudo port install libgeoip
</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p>You will also have to modify the <code>PATH</code> in your <code>.profile</code> so that the MacPorts programs are accessible from the command-line:</p> <pre data-language="console">export PATH=/opt/local/bin:/opt/local/lib/postgresql13/bin
</pre> <p>In addition, add the <code>DYLD_FALLBACK_LIBRARY_PATH</code> setting so that the libraries can be found by Python:</p> <pre data-language="console">export DYLD_FALLBACK_LIBRARY_PATH=/opt/local/lib:/opt/local/lib/postgresql13
</pre> </div>    <h3 id="id19">Windows</h3> <p id="s-windows">Proceed through the following sections sequentially in order to install GeoDjango on Windows. In this tutorial we will install 64 bit versions of each application.</p>  <h4 id="id20">Python</h4> <p id="s-id20">Install a 64 bit version of Python. See <a class="reference internal" href="../../../../howto/windows"><span class="doc">Install Python</span></a> for further information.</p>   <h4 id="postgresql">PostgreSQL</h4> <p id="s-postgresql">Download the latest <a class="reference external" href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">PostgreSQL 12.x installer</a> from the <a class="reference external" href="https://www.enterprisedb.com">EnterpriseDB</a> website. After downloading, run the installer, follow the on-screen directions, and keep the default options unless you know the consequences of changing them.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The PostgreSQL installer creates a new <code>postgres</code> database superuser You will be prompted once to set the password – make sure to remember it!</p> </div> <p>When the installer completes, it will ask to “Launch Stack Builder at exit?” – keep this checked, as it is necessary to install <a class="reference internal" href="#postgisasb"><span class="std std-ref">PostGIS</span></a>.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">If installed successfully, the PostgreSQL server will run in the background each time the system as started as a Windows service. A <span class="menuselection">PostgreSQL 12</span> start menu group will created and contains shortcuts for the Application Stack Builder (ASB) as well as the ‘SQL Shell’, which will launch a <code>psql</code> command window.</p> </div>   <h4 id="postgisasb">PostGIS</h4> <p id="s-postgis">From within the Stack Builder (to run outside of the installer, <span class="menuselection">Start ‣ PostgreSQL 12 ‣ Application Stack Builder</span>), select <span class="menuselection">PostgreSQL 12 (x64) on port 5432</span> from the drop down menu and click next. Expand the <span class="menuselection">Categories ‣ Spatial Extensions</span> menu tree and select <span class="menuselection">PostGIS X.Y for PostgreSQL 12</span>.</p> <p>After clicking next, you will be prompted to confirm the selected package and “Download directory”. Click next again, this will download PostGIS and you will be asked to click next to begin the PostGIS installer. Select the default options during install. The install process includes three Yes/No dialog boxes, the default option for all three is “No”.</p>   <h4 id="id23">OSGeo4W</h4> <p id="s-osgeo4w">The <a class="reference external" href="https://trac.osgeo.org/osgeo4w/">OSGeo4W installer</a> helps to install the PROJ, GDAL, and GEOS libraries required by GeoDjango. First, download the <a class="reference external" href="https://trac.osgeo.org/osgeo4w/">OSGeo4W installer</a> (64bit), and run it. Select <span class="menuselection">Express Web-GIS Install</span> and click next. In the ‘Select Packages’ list, ensure that GDAL is selected; MapServer is also enabled by default, but is not required by GeoDjango and may be unchecked safely. After clicking next and accepting the license agreements, the packages will be automatically downloaded and installed, after which you may exit the installer.</p>   <h4 id="modify-windows-environment">Modify Windows environment</h4> <p id="s-modify-windows-environment">In order to use GeoDjango, you will need to add your OSGeo4W directories to your Windows system <code>Path</code>, as well as create <code>GDAL_DATA</code> and <code>PROJ_LIB</code> environment variables. The following set of commands, executable with <code>cmd.exe</code>, will set this up. Restart your device once this is complete for new environment variables to be recognized:</p> <pre data-language="bat">set OSGEO4W_ROOT=C:\OSGeo4W64
set GDAL_DATA=%OSGEO4W_ROOT%\share\gdal
set PROJ_LIB=%OSGEO4W_ROOT%\share\proj
set PATH=%PATH%;%OSGEO4W_ROOT%\bin
reg ADD "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" /v Path /t REG_EXPAND_SZ /f /d "%PATH%"
reg ADD "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" /v GDAL_DATA /t REG_EXPAND_SZ /f /d "%GDAL_DATA%"
reg ADD "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" /v PROJ_LIB /t REG_EXPAND_SZ /f /d "%PROJ_LIB%"
</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This assumes 64bit version of OSGeo4W is installed. If you have installed the 32bit version you will need to change the first command to <code>set OSGEO4W_ROOT=C:\OSGeo4W</code>.</p> </div> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Administrator privileges are required to execute these commands. To do this, run command prompt as administrator and enter the commands above. You need to log out and log back in again for the settings to take effect.</p> </div> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">If you customized the OSGeo4W installation directories, then you will need to modify the <code>OSGEO4W_ROOT</code> variables accordingly.</p> </div>   <h4 id="install-django-and-set-up-database">Install Django and set up database</h4> <p id="s-install-django-and-set-up-database"><a class="reference internal" href="../../../../topics/install#installing-official-release"><span class="std std-ref">install Django</span></a> on your system. It is recommended that you create a <a class="reference external" href="https://docs.python.org/3/tutorial/venv.html" title="(in Python v3.10)"><span class="xref std std-doc">virtual environment</span></a> for each project you create.</p>   <h4 id="id24">psycopg2</h4> <p id="s-id24">The <code>psycopg2</code> Python module provides the interface between Python and the PostgreSQL database. <code>psycopg2</code> can be installed via pip within your Python virtual environment:</p> <pre data-language="console">...\&gt; py -m pip install psycopg2
</pre> <h4 class="rubric">Footnotes</h4> <table class="docutils footnote" frame="void" id="id25" rules="none">   <tr>
<td class="label"><a class="fn-backref" href="#id5">[1]</a></td>
<td>GeoDjango uses the <a class="reference external" href="https://docs.python.org/3/library/ctypes.html#ctypes.util.find_library" title="(in Python v3.10)"><code>find_library()</code></a> routine from <code>ctypes.util</code> to locate shared libraries.</td>
</tr>  </table><div class="_attribution">
  <p class="_attribution-p">
    &copy; Django Software Foundation and individual contributors<br>Licensed under the BSD License.<br>
    <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/gis/install/index/" class="_attribution-link">https://docs.djangoproject.com/en/4.0/ref/contrib/gis/install/index/</a>
  </p>
</div>
