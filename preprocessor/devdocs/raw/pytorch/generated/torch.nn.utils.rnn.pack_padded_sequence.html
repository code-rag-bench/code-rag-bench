<h1 id="torch-nn-utils-rnn-pack-padded-sequence">torch.nn.utils.rnn.pack_padded_sequence</h1> <dl class="function"> <dt id="torch.nn.utils.rnn.pack_padded_sequence">
<code>torch.nn.utils.rnn.pack_padded_sequence(input, lengths, batch_first=False, enforce_sorted=True)</code> <a class="reference internal" href="https://pytorch.org/docs/1.8.0/_modules/torch/nn/utils/rnn.html#pack_padded_sequence"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Packs a Tensor containing padded sequences of variable length.</p> <p><code>input</code> can be of size <code>T x B x *</code> where <code>T</code> is the length of the longest sequence (equal to <code>lengths[0]</code>), <code>B</code> is the batch size, and <code>*</code> is any number of dimensions (including 0). If <code>batch_first</code> is <code>True</code>, <code>B x T x *</code> <code>input</code> is expected.</p> <p>For unsorted sequences, use <code>enforce_sorted = False</code>. If <code>enforce_sorted</code> is <code>True</code>, the sequences should be sorted by length in a decreasing order, i.e. <code>input[:,0]</code> should be the longest sequence, and <code>input[:,B-1]</code> the shortest one. <code>enforce_sorted = True</code> is only necessary for ONNX export.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This function accepts any input that has at least two dimensions. You can apply it to pack the labels, and use the output of the RNN with them to compute the loss directly. A Tensor can be retrieved from a <a class="reference internal" href="torch.nn.utils.rnn.packedsequence#torch.nn.utils.rnn.PackedSequence" title="torch.nn.utils.rnn.PackedSequence"><code>PackedSequence</code></a> object by accessing its <code>.data</code> attribute.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>input</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – padded batch of variable length sequences.</li> <li>
<strong>lengths</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><em>)</em>) – list of sequence lengths of each batch element (must be on the CPU if provided as a tensor).</li> <li>
<strong>batch_first</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a><em>, </em><em>optional</em>) – if <code>True</code>, the input is expected in <code>B x T x *</code> format.</li> <li>
<strong>enforce_sorted</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a><em>, </em><em>optional</em>) – if <code>True</code>, the input is expected to contain sequences sorted by length in a decreasing order. If <code>False</code>, the input will get sorted unconditionally. Default: <code>True</code>.</li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>a <a class="reference internal" href="torch.nn.utils.rnn.packedsequence#torch.nn.utils.rnn.PackedSequence" title="torch.nn.utils.rnn.PackedSequence"><code>PackedSequence</code></a> object</p> </dd> </dl> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 Torch Contributors<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://pytorch.org/docs/1.8.0/generated/torch.nn.utils.rnn.pack_padded_sequence.html" class="_attribution-link">https://pytorch.org/docs/1.8.0/generated/torch.nn.utils.rnn.pack_padded_sequence.html</a>
  </p>
</div>
