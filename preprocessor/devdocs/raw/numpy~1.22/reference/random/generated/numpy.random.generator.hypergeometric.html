<h1>numpy.random.Generator.hypergeometric</h1> <p>method</p> <dl class="py method"> <dt class="sig sig-object py" id="numpy.random.Generator.hypergeometric"> <span class="sig-prename descclassname">random.Generator.</span><span class="sig-name descname">hypergeometric</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">ngood</span></em>, <em class="sig-param"><span class="n">nbad</span></em>, <em class="sig-param"><span class="n">nsample</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Draw samples from a Hypergeometric distribution.</p> <p>Samples are drawn from a hypergeometric distribution with specified parameters, <code>ngood</code> (ways to make a good selection), <code>nbad</code> (ways to make a bad selection), and <code>nsample</code> (number of items sampled, which is less than or equal to the sum <code>ngood + nbad</code>).</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>ngood</strong><span class="classifier">int or array_like of ints</span>
</dt>
<dd>
<p>Number of ways to make a good selection. Must be nonnegative and less than 10**9.</p> </dd> <dt>
<strong>nbad</strong><span class="classifier">int or array_like of ints</span>
</dt>
<dd>
<p>Number of ways to make a bad selection. Must be nonnegative and less than 10**9.</p> </dd> <dt>
<strong>nsample</strong><span class="classifier">int or array_like of ints</span>
</dt>
<dd>
<p>Number of items sampled. Must be nonnegative and less than <code>ngood + nbad</code>.</p> </dd> <dt>
<strong>size</strong><span class="classifier">int or tuple of ints, optional</span>
</dt>
<dd>
<p>Output shape. If the given shape is, e.g., <code>(m, n, k)</code>, then <code>m * n * k</code> samples are drawn. If size is <code>None</code> (default), a single value is returned if <code>ngood</code>, <code>nbad</code>, and <code>nsample</code> are all scalars. Otherwise, <code>np.broadcast(ngood, nbad, nsample).size</code> samples are drawn.</p> </dd> </dl> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<dl class="simple"> <dt>
<strong>out</strong><span class="classifier">ndarray or scalar</span>
</dt>
<dd>
<p>Drawn samples from the parameterized hypergeometric distribution. Each sample is the number of good items within a randomly selected subset of size <code>nsample</code> taken from a set of <code>ngood</code> good items and <code>nbad</code> bad items.</p> </dd> </dl> </dd> </dl> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="numpy.random.generator.multivariate_hypergeometric#numpy.random.Generator.multivariate_hypergeometric" title="numpy.random.Generator.multivariate_hypergeometric"><code>multivariate_hypergeometric</code></a></dt>
<dd>
<p>Draw samples from the multivariate hypergeometric distribution.</p> </dd> <dt><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.stats.hypergeom.html#scipy.stats.hypergeom" title="(in SciPy v1.7.1)"><code>scipy.stats.hypergeom</code></a></dt>
<dd>
<p>probability density function, distribution or cumulative density function, etc.</p> </dd> </dl> </div> <h4 class="rubric">Notes</h4> <p>The probability density for the Hypergeometric distribution is</p> <div class="math notranslate nohighlight"> \[P(x) = \frac{\binom{g}{x}\binom{b}{n-x}}{\binom{g+b}{n}},\]</div> <p>where <span class="math notranslate nohighlight">\(0 \le x \le n\)</span> and <span class="math notranslate nohighlight">\(n-b \le x \le g\)</span></p> <p>for P(x) the probability of <code>x</code> good results in the drawn sample, g = <code>ngood</code>, b = <code>nbad</code>, and n = <code>nsample</code>.</p> <p>Consider an urn with black and white marbles in it, <code>ngood</code> of them are black and <code>nbad</code> are white. If you draw <code>nsample</code> balls without replacement, then the hypergeometric distribution describes the distribution of black balls in the drawn sample.</p> <p>Note that this distribution is very similar to the binomial distribution, except that in this case, samples are drawn without replacement, whereas in the Binomial case samples are drawn with replacement (or the sample space is infinite). As the sample space becomes large, this distribution approaches the binomial.</p> <p>The arguments <code>ngood</code> and <code>nbad</code> each must be less than <code>10**9</code>. For extremely large arguments, the algorithm that is used to compute the samples <a class="reference internal" href="#r688e4aa3bfc3-4" id="id1">[4]</a> breaks down because of loss of precision in floating point calculations. For such large values, if <code>nsample</code> is not also large, the distribution can be approximated with the binomial distribution, <code>binomial(n=nsample, p=ngood/(ngood + nbad))</code>.</p> <h4 class="rubric">References</h4> <dl class="citation"> <dt class="label" id="r688e4aa3bfc3-1"><span class="brackets">1</span></dt> <dd>
<p>Lentner, Marvin, “Elementary Applied Statistics”, Bogden and Quigley, 1972.</p> </dd> <dt class="label" id="r688e4aa3bfc3-2"><span class="brackets">2</span></dt> <dd>
<p>Weisstein, Eric W. “Hypergeometric Distribution.” From MathWorld–A Wolfram Web Resource. <a class="reference external" href="http://mathworld.wolfram.com/HypergeometricDistribution.html">http://mathworld.wolfram.com/HypergeometricDistribution.html</a></p> </dd> <dt class="label" id="r688e4aa3bfc3-3"><span class="brackets">3</span></dt> <dd>
<p>Wikipedia, “Hypergeometric distribution”, <a class="reference external" href="https://en.wikipedia.org/wiki/Hypergeometric_distribution">https://en.wikipedia.org/wiki/Hypergeometric_distribution</a></p> </dd> <dt class="label" id="r688e4aa3bfc3-4"><span class="brackets"><a class="fn-backref" href="#id1">4</a></span></dt> <dd>
<p>Stadlober, Ernst, “The ratio of uniforms approach for generating discrete random variates”, Journal of Computational and Applied Mathematics, 31, pp. 181-189 (1990).</p> </dd> </dl> <h4 class="rubric">Examples</h4> <p>Draw samples from the distribution:</p> <pre data-language="python">&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; ngood, nbad, nsamp = 100, 2, 10
# number of good, number of bad, and number of samples
&gt;&gt;&gt; s = rng.hypergeometric(ngood, nbad, nsamp, 1000)
&gt;&gt;&gt; from matplotlib.pyplot import hist
&gt;&gt;&gt; hist(s)
#   note that it is very unlikely to grab both bad items
</pre> <p>Suppose you have an urn with 15 white and 15 black marbles. If you pull 15 marbles at random, how likely is it that 12 or more of them are one color?</p> <pre data-language="python">&gt;&gt;&gt; s = rng.hypergeometric(15, 15, 15, 100000)
&gt;&gt;&gt; sum(s&gt;=12)/100000. + sum(s&lt;=3)/100000.
#   answer = 0.003 ... pretty unlikely!
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2021 NumPy Developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://numpy.org/doc/1.22/reference/random/generated/numpy.random.Generator.hypergeometric.html" class="_attribution-link">https://numpy.org/doc/1.22/reference/random/generated/numpy.random.Generator.hypergeometric.html</a>
  </p>
</div>
