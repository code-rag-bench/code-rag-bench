<h1>Random sampling (numpy.random)</h1> <p>Numpy’s random number routines produce pseudo random numbers using combinations of a <a class="reference internal" href="bit_generators/generated/numpy.random.bitgenerator#numpy.random.BitGenerator" title="numpy.random.BitGenerator"><code>BitGenerator</code></a> to create sequences and a <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a> to use those sequences to sample from different statistical distributions:</p> <ul class="simple"> <li>BitGenerators: Objects that generate random numbers. These are typically unsigned integer words filled with sequences of either 32 or 64 random bits.</li> <li>Generators: Objects that transform sequences of random bits from a BitGenerator into sequences of numbers that follow a specific probability distribution (such as uniform, Normal or Binomial) within a specified interval.</li> </ul> <p>Since Numpy version 1.17.0 the Generator can be initialized with a number of different BitGenerators. It exposes many different probability distributions. See <a class="reference external" href="https://www.numpy.org/neps/nep-0019-rng-policy.html">NEP 19</a> for context on the updated random Numpy number routines. The legacy <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a> random number routines are still available, but limited to a single BitGenerator. See <a class="reference internal" href="new-or-different#new-or-different"><span class="std std-ref">What’s New or Different</span></a> for a complete list of improvements and differences from the legacy <code>RandomState</code>.</p> <p>For convenience and backward compatibility, a single <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a> instance’s methods are imported into the numpy.random namespace, see <a class="reference internal" href="legacy#legacy"><span class="std std-ref">Legacy Random Generation</span></a> for the complete list.</p> <section id="quick-start"> <h2 id="random-quick-start">Quick Start</h2> <p>Call <a class="reference internal" href="generator#numpy.random.default_rng" title="numpy.random.default_rng"><code>default_rng</code></a> to get a new instance of a <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a>, then call its methods to obtain samples from different distributions. By default, <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a> uses bits provided by <a class="reference internal" href="bit_generators/pcg64#numpy.random.PCG64" title="numpy.random.PCG64"><code>PCG64</code></a> which has better statistical properties than the legacy <a class="reference internal" href="bit_generators/mt19937#numpy.random.MT19937" title="numpy.random.MT19937"><code>MT19937</code></a> used in <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a>.</p> <pre data-language="python"># Do this (new version)
from numpy.random import default_rng
rng = default_rng()
vals = rng.standard_normal(10)
more_vals = rng.standard_normal(10)

# instead of this (legacy version)
from numpy import random
vals = random.standard_normal(10)
more_vals = random.standard_normal(10)
</pre> <p><a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a> can be used as a replacement for <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a>. Both class instances hold an internal <a class="reference internal" href="bit_generators/generated/numpy.random.bitgenerator#numpy.random.BitGenerator" title="numpy.random.BitGenerator"><code>BitGenerator</code></a> instance to provide the bit stream, it is accessible as <code>gen.bit_generator</code>. Some long-overdue API cleanup means that legacy and compatibility methods have been removed from <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a></p> <table class="table">   <tr>
<td><p><a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a></p></td> <td><p><a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a></p></td> <td><p>Notes</p></td> </tr> <tr>
<td><p><code>random_sample</code>,</p></td> <td><p><code>random</code></p></td> <td><p>Compatible with <a class="reference external" href="https://docs.python.org/dev/library/random.html#random.random" title="(in Python v3.11)"><code>random.random</code></a></p></td> </tr> <tr>
<td><p><code>rand</code></p></td> <td></td> <td></td> </tr> <tr>
<td><p><code>randint</code>,</p></td> <td><p><code>integers</code></p></td> <td><p>Add an <code>endpoint</code> kwarg</p></td> </tr> <tr>
<td><p><code>random_integers</code></p></td> <td></td> <td></td> </tr> <tr>
<td><p><code>tomaxint</code></p></td> <td><p>removed</p></td> <td><p>Use <code>integers(0, np.iinfo(np.int_).max,</code> <code>endpoint=False)</code></p></td> </tr> <tr>
<td><p><code>seed</code></p></td> <td><p>removed</p></td> <td><p>Use <a class="reference internal" href="bit_generators/generated/numpy.random.seedsequence.spawn#numpy.random.SeedSequence.spawn" title="numpy.random.SeedSequence.spawn"><code>SeedSequence.spawn</code></a></p></td> </tr>  </table> <p>See <a class="reference internal" href="new-or-different#new-or-different"><span class="std std-ref">What’s New or Different</span></a> for more information.</p> <p>Something like the following code can be used to support both <code>RandomState</code> and <code>Generator</code>, with the understanding that the interfaces are slightly different</p> <pre data-language="python">try:
    rng_integers = rng.integers
except AttributeError:
    rng_integers = rng.randint
a = rng_integers(1000)
</pre> <p>Seeds can be passed to any of the BitGenerators. The provided value is mixed via <a class="reference internal" href="bit_generators/generated/numpy.random.seedsequence#numpy.random.SeedSequence" title="numpy.random.SeedSequence"><code>SeedSequence</code></a> to spread a possible sequence of seeds across a wider range of initialization states for the BitGenerator. Here <a class="reference internal" href="bit_generators/pcg64#numpy.random.PCG64" title="numpy.random.PCG64"><code>PCG64</code></a> is used and is wrapped with a <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a>.</p> <pre data-language="python">from numpy.random import Generator, PCG64
rng = Generator(PCG64(12345))
rng.standard_normal()
</pre> <p>Here we use <a class="reference internal" href="generator#numpy.random.default_rng" title="numpy.random.default_rng"><code>default_rng</code></a> to create an instance of <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a> to generate a random float:</p> <pre data-language="python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; rng = np.random.default_rng(12345)
&gt;&gt;&gt; print(rng)
Generator(PCG64)
&gt;&gt;&gt; rfloat = rng.random()
&gt;&gt;&gt; rfloat
0.22733602246716966
&gt;&gt;&gt; type(rfloat)
&lt;class 'float'&gt;
</pre> <p>Here we use <a class="reference internal" href="generator#numpy.random.default_rng" title="numpy.random.default_rng"><code>default_rng</code></a> to create an instance of <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a> to generate 3 random integers between 0 (inclusive) and 10 (exclusive):</p> <pre data-language="python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; rng = np.random.default_rng(12345)
&gt;&gt;&gt; rints = rng.integers(low=0, high=10, size=3)
&gt;&gt;&gt; rints
array([6, 2, 7])
&gt;&gt;&gt; type(rints[0])
&lt;class 'numpy.int64'&gt;
</pre> </section> <section id="introduction"> <h2>Introduction</h2> <p>The new infrastructure takes a different approach to producing random numbers from the <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a> object. Random number generation is separated into two components, a bit generator and a random generator.</p> <p>The <a class="reference internal" href="bit_generators/generated/numpy.random.bitgenerator#numpy.random.BitGenerator" title="numpy.random.BitGenerator"><code>BitGenerator</code></a> has a limited set of responsibilities. It manages state and provides functions to produce random doubles and random unsigned 32- and 64-bit values.</p> <p>The <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>random generator</code></a> takes the bit generator-provided stream and transforms them into more useful distributions, e.g., simulated normal random values. This structure allows alternative bit generators to be used with little code duplication.</p> <p>The <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a> is the user-facing object that is nearly identical to the legacy <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a>. It accepts a bit generator instance as an argument. The default is currently <a class="reference internal" href="bit_generators/pcg64#numpy.random.PCG64" title="numpy.random.PCG64"><code>PCG64</code></a> but this may change in future versions. As a convenience NumPy provides the <a class="reference internal" href="generator#numpy.random.default_rng" title="numpy.random.default_rng"><code>default_rng</code></a> function to hide these details:</p> <pre data-language="python">&gt;&gt;&gt; from numpy.random import default_rng
&gt;&gt;&gt; rng = default_rng(12345)
&gt;&gt;&gt; print(rng)
Generator(PCG64)
&gt;&gt;&gt; print(rng.random())
0.22733602246716966
</pre> <p>One can also instantiate <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a> directly with a <a class="reference internal" href="bit_generators/generated/numpy.random.bitgenerator#numpy.random.BitGenerator" title="numpy.random.BitGenerator"><code>BitGenerator</code></a> instance.</p> <p>To use the default <a class="reference internal" href="bit_generators/pcg64#numpy.random.PCG64" title="numpy.random.PCG64"><code>PCG64</code></a> bit generator, one can instantiate it directly and pass it to <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a>:</p> <pre data-language="python">&gt;&gt;&gt; from numpy.random import Generator, PCG64
&gt;&gt;&gt; rng = Generator(PCG64(12345))
&gt;&gt;&gt; print(rng)
Generator(PCG64)
</pre> <p>Similarly to use the older <a class="reference internal" href="bit_generators/mt19937#numpy.random.MT19937" title="numpy.random.MT19937"><code>MT19937</code></a> bit generator (not recommended), one can instantiate it directly and pass it to <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a>:</p> <pre data-language="python">&gt;&gt;&gt; from numpy.random import Generator, MT19937
&gt;&gt;&gt; rng = Generator(MT19937(12345))
&gt;&gt;&gt; print(rng)
Generator(MT19937)
</pre> <section id="what-s-new-or-different"> <h3>What’s New or Different</h3> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>The Box-Muller method used to produce NumPy’s normals is no longer available in <a class="reference internal" href="generator#numpy.random.Generator" title="numpy.random.Generator"><code>Generator</code></a>. It is not possible to reproduce the exact random values using Generator for the normal distribution or any other distribution that relies on the normal such as the <a class="reference internal" href="generated/numpy.random.randomstate.gamma#numpy.random.RandomState.gamma" title="numpy.random.RandomState.gamma"><code>RandomState.gamma</code></a> or <a class="reference internal" href="generated/numpy.random.randomstate.standard_t#numpy.random.RandomState.standard_t" title="numpy.random.RandomState.standard_t"><code>RandomState.standard_t</code></a>. If you require bitwise backward compatible streams, use <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a>.</p> </div> <ul class="simple"> <li>The Generator’s normal, exponential and gamma functions use 256-step Ziggurat methods which are 2-10 times faster than NumPy’s Box-Muller or inverse CDF implementations.</li> <li>Optional <code>dtype</code> argument that accepts <code>np.float32</code> or <code>np.float64</code> to produce either single or double prevision uniform random variables for select distributions</li> <li>Optional <code>out</code> argument that allows existing arrays to be filled for select distributions</li> <li>All BitGenerators can produce doubles, uint64s and uint32s via CTypes (<a class="reference internal" href="bit_generators/generated/numpy.random.pcg64.ctypes#numpy.random.PCG64.ctypes" title="numpy.random.PCG64.ctypes"><code>PCG64.ctypes</code></a>) and CFFI (<a class="reference internal" href="bit_generators/generated/numpy.random.pcg64.cffi#numpy.random.PCG64.cffi" title="numpy.random.PCG64.cffi"><code>PCG64.cffi</code></a>). This allows the bit generators to be used in numba.</li> <li>The bit generators can be used in downstream projects via <a class="reference internal" href="extending#random-cython"><span class="std std-ref">Cython</span></a>.</li> <li>
<a class="reference internal" href="generated/numpy.random.generator.integers#numpy.random.Generator.integers" title="numpy.random.Generator.integers"><code>Generator.integers</code></a> is now the canonical way to generate integer random numbers from a discrete uniform distribution. The <code>rand</code> and <code>randn</code> methods are only available through the legacy <a class="reference internal" href="legacy#numpy.random.RandomState" title="numpy.random.RandomState"><code>RandomState</code></a>. The <code>endpoint</code> keyword can be used to specify open or closed intervals. This replaces both <code>randint</code> and the deprecated <code>random_integers</code>.</li> <li>
<a class="reference internal" href="generated/numpy.random.generator.random#numpy.random.Generator.random" title="numpy.random.Generator.random"><code>Generator.random</code></a> is now the canonical way to generate floating-point random numbers, which replaces <a class="reference internal" href="generated/numpy.random.randomstate.random_sample#numpy.random.RandomState.random_sample" title="numpy.random.RandomState.random_sample"><code>RandomState.random_sample</code></a>, <code>RandomState.sample</code>, and <code>RandomState.ranf</code>. This is consistent with Python’s <a class="reference external" href="https://docs.python.org/dev/library/random.html#random.random" title="(in Python v3.11)"><code>random.random</code></a>.</li> <li>All BitGenerators in numpy use <a class="reference internal" href="bit_generators/generated/numpy.random.seedsequence#numpy.random.SeedSequence" title="numpy.random.SeedSequence"><code>SeedSequence</code></a> to convert seeds into initialized states.</li> <li>The addition of an <code>axis</code> keyword argument to methods such as <a class="reference internal" href="generated/numpy.random.generator.choice#numpy.random.Generator.choice" title="numpy.random.Generator.choice"><code>Generator.choice</code></a>, <a class="reference internal" href="generated/numpy.random.generator.permutation#numpy.random.Generator.permutation" title="numpy.random.Generator.permutation"><code>Generator.permutation</code></a>, and <a class="reference internal" href="generated/numpy.random.generator.shuffle#numpy.random.Generator.shuffle" title="numpy.random.Generator.shuffle"><code>Generator.shuffle</code></a> improves support for sampling from and shuffling multi-dimensional arrays.</li> </ul> <p>See <a class="reference internal" href="new-or-different#new-or-different"><span class="std std-ref">What’s New or Different</span></a> for a complete list of improvements and differences from the traditional <code>Randomstate</code>.</p> </section> <section id="parallel-generation"> <h3>Parallel Generation</h3> <p>The included generators can be used in parallel, distributed applications in one of three ways:</p> <ul class="simple"> <li><a class="reference internal" href="parallel#seedsequence-spawn"><span class="std std-ref">SeedSequence spawning</span></a></li> <li><a class="reference internal" href="parallel#independent-streams"><span class="std std-ref">Independent Streams</span></a></li> <li><a class="reference internal" href="parallel#parallel-jumped"><span class="std std-ref">Jumping the BitGenerator state</span></a></li> </ul> <p>Users with a very large amount of parallelism will want to consult <a class="reference internal" href="upgrading-pcg64#upgrading-pcg64"><span class="std std-ref">Upgrading PCG64 with PCG64DXSM</span></a>.</p> </section> </section> <section id="concepts"> <h2>Concepts</h2>  <ul> <li class="toctree-l1"><a class="reference internal" href="generator">Random Generator</a></li> <li class="toctree-l1"><a class="reference internal" href="legacy">Legacy Generator (RandomState)</a></li> <li class="toctree-l1"><a class="reference internal" href="bit_generators/index">Bit Generators</a></li> <li class="toctree-l1"><a class="reference internal" href="bit_generators/index#seeding-and-entropy">Seeding and Entropy</a></li> <li class="toctree-l1"><a class="reference internal" href="upgrading-pcg64">Upgrading PCG64 with PCG64DXSM</a></li> </ul>  </section> <section id="features"> <h2>Features</h2>  <ul> <li class="toctree-l1">
<a class="reference internal" href="parallel">Parallel Applications</a><ul> <li class="toctree-l2"><a class="reference internal" href="parallel#seedsequence-spawning"><code>SeedSequence</code> spawning</a></li> <li class="toctree-l2"><a class="reference internal" href="parallel#independent-streams">Independent Streams</a></li> <li class="toctree-l2"><a class="reference internal" href="parallel#jumping-the-bitgenerator-state">Jumping the BitGenerator state</a></li> </ul> </li> <li class="toctree-l1"><a class="reference internal" href="multithreading">Multithreaded Generation</a></li> <li class="toctree-l1"><a class="reference internal" href="new-or-different">What’s New or Different</a></li> <li class="toctree-l1">
<a class="reference internal" href="performance">Comparing Performance</a><ul> <li class="toctree-l2"><a class="reference internal" href="performance#recommendation">Recommendation</a></li> <li class="toctree-l2"><a class="reference internal" href="performance#timings">Timings</a></li> <li class="toctree-l2"><a class="reference internal" href="performance#performance-on-different-operating-systems">Performance on different Operating Systems</a></li> </ul> </li> <li class="toctree-l1"><a class="reference internal" href="c-api">C API for random</a></li> <li class="toctree-l1">
<a class="reference internal" href="extending">Examples of using Numba, Cython, CFFI</a><ul> <li class="toctree-l2"><a class="reference internal" href="extending#numba">Numba</a></li> <li class="toctree-l2"><a class="reference internal" href="extending#cython">Cython</a></li> <li class="toctree-l2"><a class="reference internal" href="extending#cffi">CFFI</a></li> <li class="toctree-l2"><a class="reference internal" href="extending#new-bit-generators">New Bit Generators</a></li> <li class="toctree-l2"><a class="reference internal" href="extending#examples">Examples</a></li> </ul> </li> </ul>  <section id="original-source-of-the-generator-and-bitgenerators"> <h3>Original Source of the Generator and BitGenerators</h3> <p>This package was developed independently of NumPy and was integrated in version 1.17.0. The original repo is at <a class="reference external" href="https://github.com/bashtage/randomgen">https://github.com/bashtage/randomgen</a>.</p> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2021 NumPy Developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://numpy.org/doc/1.22/reference/random/index.html" class="_attribution-link">https://numpy.org/doc/1.22/reference/random/index.html</a>
  </p>
</div>
