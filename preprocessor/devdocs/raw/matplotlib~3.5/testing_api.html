<h1>matplotlib.testing</h1> <section id="matplotlib-test"> <h2>matplotlib.test()</h2> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.test"> <span class="sig-prename descclassname">matplotlib.</span><span class="sig-name descname">test</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbosity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coverage</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/_api/deprecation.py#L1216-L1263"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>[<em>Deprecated</em>] Run the matplotlib test suite.</p> <h4 class="rubric">Notes</h4> <div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 3.5.</span></p> </div> </dd>
</dl> </section> <section id="id1"> <h2>matplotlib.testing</h2> <p id="module-matplotlib.testing">Helper functions for testing.</p> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.set_font_settings_for_testing"> <span class="sig-prename descclassname">matplotlib.testing.</span><span class="sig-name descname">set_font_settings_for_testing</span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/__init__.py#L17-L20"><span class="viewcode-link">[source]</span></a>
</dt> 
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.set_reproducibility_for_testing"> <span class="sig-prename descclassname">matplotlib.testing.</span><span class="sig-name descname">set_reproducibility_for_testing</span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/__init__.py#L23-L24"><span class="viewcode-link">[source]</span></a>
</dt> 
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.setup"> <span class="sig-prename descclassname">matplotlib.testing.</span><span class="sig-name descname">setup</span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/__init__.py#L27-L49"><span class="viewcode-link">[source]</span></a>
</dt> 
</dl> </section> <section id="module-matplotlib.testing.compare"> <h2 id="matplotlib-testing-compare">matplotlib.testing.compare</h2> <p>Utilities for comparing image results.</p> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.compare.calculate_rms"> <span class="sig-prename descclassname">matplotlib.testing.compare.</span><span class="sig-name descname">calculate_rms</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">expected_image</span></em>, <em class="sig-param"><span class="n">actual_image</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/compare.py#L338-L347"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Calculate the per-pixel errors, then compute the root mean square error.</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.compare.comparable_formats"> <span class="sig-prename descclassname">matplotlib.testing.compare.</span><span class="sig-name descname">comparable_formats</span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/compare.py#L243-L254"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Return the list of file formats that <a class="reference internal" href="#matplotlib.testing.compare.compare_images" title="matplotlib.testing.compare.compare_images"><code>compare_images</code></a> can compare on this system.</p> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<dl class="simple"> <dt>list of str</dt>
<dd>
<p>E.g. <code>['png', 'pdf', 'svg', 'eps']</code>.</p> </dd> </dl> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.compare.compare_images"> <span class="sig-prename descclassname">matplotlib.testing.compare.</span><span class="sig-name descname">compare_images</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">expected</span></em>, <em class="sig-param"><span class="n">actual</span></em>, <em class="sig-param"><span class="n">tol</span></em>, <em class="sig-param"><span class="n">in_decorator</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/compare.py#L354-L455"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Compare two "image" files checking differences within a tolerance.</p> <p>The two given filenames may point to files which are convertible to PNG via the <code>converter</code> dictionary. The underlying RMS is calculated with the <a class="reference internal" href="#matplotlib.testing.compare.calculate_rms" title="matplotlib.testing.compare.calculate_rms"><code>calculate_rms</code></a> function.</p> <dl class="field-list"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>expected</strong><span class="classifier">str</span>
</dt>
<dd>
<p>The filename of the expected image.</p> </dd> <dt>
<strong>actual</strong><span class="classifier">str</span>
</dt>
<dd>
<p>The filename of the actual image.</p> </dd> <dt>
<strong>tol</strong><span class="classifier">float</span>
</dt>
<dd>
<p>The tolerance (a color value difference, where 255 is the maximal difference). The test fails if the average pixel difference is greater than this value.</p> </dd> <dt>
<strong>in_decorator</strong><span class="classifier">bool</span>
</dt>
<dd>
<p>Determines the output format. If called from image_comparison decorator, this should be True. (default=False)</p> </dd> </dl> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<dl> <dt>None or dict or str</dt>
<dd>
<p>Return <em>None</em> if the images are equal within the given tolerance.</p> <p>If the images differ, the return value depends on <em>in_decorator</em>. If <em>in_decorator</em> is true, a dict with the following entries is returned:</p> <ul class="simple"> <li>
<em>rms</em>: The RMS of the image difference.</li> <li>
<em>expected</em>: The filename of the expected image.</li> <li>
<em>actual</em>: The filename of the actual image.</li> <li>
<em>diff_image</em>: The filename of the difference image.</li> <li>
<em>tol</em>: The comparison tolerance.</li> </ul> <p>Otherwise, a human-readable multi-line string representation of this information is returned.</p> </dd> </dl> </dd> </dl> <h4 class="rubric">Examples</h4> <pre data-language="python">img1 = "./baseline/plot.png"
img2 = "./output/plot.png"
compare_images(img1, img2, 0.001)
</pre> </dd>
</dl> </section> <section id="module-matplotlib.testing.decorators"> <h2 id="matplotlib-testing-decorators">matplotlib.testing.decorators</h2> <dl class="py class"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.CleanupTestCase"> <em class="property">class</em><span class="sig-prename descclassname">matplotlib.testing.decorators.</span><span class="sig-name descname">CleanupTestCase</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">methodName</span><span class="o">=</span><span class="default_value">'runTest'</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L37-L45"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Bases: <code>unittest.case.TestCase</code></p> <p>A wrapper for unittest.TestCase that includes cleanup operations.</p> <p>Create an instance of the class that will use the named test method when executed. Raises a ValueError if the instance does not have a method with the specified name.</p> <dl class="py method"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.CleanupTestCase.setUpClass"> <em class="property">classmethod</em><span class="sig-name descname">setUpClass</span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L39-L41"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Hook method for setting up class fixture before running tests in the class.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.CleanupTestCase.tearDownClass"> <em class="property">classmethod</em><span class="sig-name descname">tearDownClass</span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L43-L45"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Hook method for deconstructing the class fixture after running all tests in the class.</p> </dd>
</dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.check_figures_equal"> <span class="sig-prename descclassname">matplotlib.testing.decorators.</span><span class="sig-name descname">check_figures_equal</span><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">extensions</span><span class="o">=</span><span class="default_value">('png', 'pdf', 'svg')</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L369-L470"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Decorator for test cases that generate and compare two figures.</p> <p>The decorated function must take two keyword arguments, <em>fig_test</em> and <em>fig_ref</em>, and draw the test and reference images on them. After the function returns, the figures are saved and compared.</p> <p>This decorator should be preferred over <a class="reference internal" href="#matplotlib.testing.decorators.image_comparison" title="matplotlib.testing.decorators.image_comparison"><code>image_comparison</code></a> when possible in order to keep the size of the test suite from ballooning.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>extensions</strong><span class="classifier">list, default: ["png", "pdf", "svg"]</span>
</dt>
<dd>
<p>The extensions to test.</p> </dd> <dt>
<strong>tol</strong><span class="classifier">float</span>
</dt>
<dd>
<p>The RMS threshold above which the test is considered failed.</p> </dd> </dl> </dd> <dt class="field-even">Raises</dt> <dd class="field-even">
<dl class="simple"> <dt>RuntimeError</dt>
<dd>
<p>If any new figures are created (and not subsequently closed) inside the test function.</p> </dd> </dl> </dd> </dl> <h4 class="rubric">Examples</h4> <p>Check that calling <a class="reference internal" href="_as_gen/matplotlib.axes.axes.plot#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot"><code>Axes.plot</code></a> with a single argument plots it against <code>[0, 1, 2, ...]</code>:</p> <pre data-language="python">@check_figures_equal()
def test_plot(fig_test, fig_ref):
    fig_test.subplots().plot([1, 3, 5])
    fig_ref.subplots().plot([0, 1, 2], [1, 3, 5])
</pre> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.check_freetype_version"> <span class="sig-prename descclassname">matplotlib.testing.decorators.</span><span class="sig-name descname">check_freetype_version</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">ver</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L89-L98"><span class="viewcode-link">[source]</span></a>
</dt> 
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.cleanup"> <span class="sig-prename descclassname">matplotlib.testing.decorators.</span><span class="sig-name descname">cleanup</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">style</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L48-L86"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>A decorator to ensure that any global state is reset before running a test.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>style</strong><span class="classifier">str, dict, or list, optional</span>
</dt>
<dd>
<p>The style(s) to apply. Defaults to <code>["classic",
"_classic_test_patch"]</code>.</p> </dd> </dl> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.image_comparison"> <span class="sig-prename descclassname">matplotlib.testing.decorators.</span><span class="sig-name descname">image_comparison</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">baseline_images</span></em>, <em class="sig-param"><span class="n">extensions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">freetype_version</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_text</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">savefig_kwarg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">style</span><span class="o">=</span><span class="default_value">('classic', '_classic_test_patch')</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L279-L366"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Compare images generated by the test with those specified in <em>baseline_images</em>, which must correspond, else an <code>ImageComparisonFailure</code> exception will be raised.</p> <dl class="field-list"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<dl> <dt>
<strong>baseline_images</strong><span class="classifier">list or None</span>
</dt>
<dd>
<p>A list of strings specifying the names of the images generated by calls to <a class="reference internal" href="figure_api#matplotlib.figure.Figure.savefig" title="matplotlib.figure.Figure.savefig"><code>Figure.savefig</code></a>.</p> <p>If <em>None</em>, the test function must use the <code>baseline_images</code> fixture, either as a parameter or with <a class="reference external" href="https://pytest.org/en/stable/reference.html#pytest.mark.usefixtures" title="(in pytest v6.2.5)"><code>pytest.mark.usefixtures</code></a>. This value is only allowed when using pytest.</p> </dd> <dt>
<strong>extensions</strong><span class="classifier">None or list of str</span>
</dt>
<dd>
<p>The list of extensions to test, e.g. <code>['png', 'pdf']</code>.</p> <p>If <em>None</em>, defaults to all supported extensions: png, pdf, and svg.</p> <p>When testing a single extension, it can be directly included in the names passed to <em>baseline_images</em>. In that case, <em>extensions</em> must not be set.</p> <p>In order to keep the size of the test suite from ballooning, we only include the <code>svg</code> or <code>pdf</code> outputs if the test is explicitly exercising a feature dependent on that backend (see also the <a class="reference internal" href="#matplotlib.testing.decorators.check_figures_equal" title="matplotlib.testing.decorators.check_figures_equal"><code>check_figures_equal</code></a> decorator for that purpose).</p> </dd> <dt>
<strong>tol</strong><span class="classifier">float, default: 0</span>
</dt>
<dd>
<p>The RMS threshold above which the test is considered failed.</p> <p>Due to expected small differences in floating-point calculations, on 32-bit systems an additional 0.06 is added to this threshold.</p> </dd> <dt>
<strong>freetype_version</strong><span class="classifier">str or tuple</span>
</dt>
<dd>
<p>The expected freetype version or range of versions for this test to pass.</p> </dd> <dt>
<strong>remove_text</strong><span class="classifier">bool</span>
</dt>
<dd>
<p>Remove the title and tick text from the figure before comparison. This is useful to make the baseline images independent of variations in text rendering between different versions of FreeType.</p> <p>This does not remove other, more deliberate, text, such as legends and annotations.</p> </dd> <dt>
<strong>savefig_kwarg</strong><span class="classifier">dict</span>
</dt>
<dd>
<p>Optional arguments that are passed to the savefig method.</p> </dd> <dt>
<strong>style</strong><span class="classifier">str, dict, or list</span>
</dt>
<dd>
<p>The optional style(s) to apply to the image test. The test itself can also apply additional styles if desired. Defaults to <code>["classic",
"_classic_test_patch"]</code>.</p> </dd> </dl> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="matplotlib.testing.decorators.remove_ticks_and_titles"> <span class="sig-prename descclassname">matplotlib.testing.decorators.</span><span class="sig-name descname">remove_ticks_and_titles</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">figure</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/decorators.py#L111-L129"><span class="viewcode-link">[source]</span></a>
</dt> 
</dl> </section> <section id="module-matplotlib.testing.exceptions"> <h2 id="matplotlib-testing-exceptions">matplotlib.testing.exceptions</h2> <dl class="py exception"> <dt class="sig sig-object py" id="matplotlib.testing.exceptions.ImageComparisonFailure"> <em class="property">exception</em><span class="sig-prename descclassname">matplotlib.testing.exceptions.</span><span class="sig-name descname">ImageComparisonFailure</span><a class="reference external" href="https://github.com/matplotlib/matplotlib/blob/v3.5.1/lib/matplotlib/testing/exceptions.py#L1-L4"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)"><code>AssertionError</code></a></p> <p>Raise this exception to mark a test as a comparison between two images.</p> </dd>
</dl> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2021 Matplotlib Development Team. All rights reserved.<br>Licensed under the Matplotlib License Agreement.<br>
    <a href="https://matplotlib.org/3.5.1/api/testing_api.html" class="_attribution-link">https://matplotlib.org/3.5.1/api/testing_api.html</a>
  </p>
</div>
