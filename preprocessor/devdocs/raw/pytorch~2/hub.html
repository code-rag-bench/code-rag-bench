<h1 id="torch-hub">torch.hub</h1> <p>Pytorch Hub is a pre-trained model repository designed to facilitate research reproducibility.</p>  <h2 id="publishing-models">Publishing models</h2> <p>Pytorch Hub supports publishing pre-trained models(model definitions and pre-trained weights) to a GitHub repository by adding a simple <code>hubconf.py</code> file;</p> <p><code>hubconf.py</code> can have multiple entrypoints. Each entrypoint is defined as a python function (example: a pre-trained model you want to publish).</p> <pre data-language="python">def entrypoint_name(*args, **kwargs):
    # args &amp; kwargs are optional, for models which take positional/keyword arguments.
    ...
</pre>  <h3 id="how-to-implement-an-entrypoint">How to implement an entrypoint?</h3> <p>Here is a code snippet specifies an entrypoint for <code>resnet18</code> model if we expand the implementation in <code>pytorch/vision/hubconf.py</code>. In most case importing the right function in <code>hubconf.py</code> is sufficient. Here we just want to use the expanded version as an example to show how it works. You can see the full script in <a class="reference external" href="https://github.com/pytorch/vision/blob/master/hubconf.py">pytorch/vision repo</a></p> <pre data-language="python">dependencies = ['torch']
from torchvision.models.resnet import resnet18 as _resnet18

# resnet18 is the name of entrypoint
def resnet18(pretrained=False, **kwargs):
    """ # This docstring shows up in hub.help()
    Resnet18 model
    pretrained (bool): kwargs, load pretrained weights into the model
    """
    # Call the model, load pretrained weights
    model = _resnet18(pretrained=pretrained, **kwargs)
    return model
</pre> <ul class="simple"> <li>
<code>dependencies</code> variable is a <strong>list</strong> of package names required to <strong>load</strong> the model. Note this might be slightly different from dependencies required for training a model.</li> <li>
<code>args</code> and <code>kwargs</code> are passed along to the real callable function.</li> <li>Docstring of the function works as a help message. It explains what does the model do and what are the allowed positional/keyword arguments. It’s highly recommended to add a few examples here.</li> <li>Entrypoint function can either return a model(nn.module), or auxiliary tools to make the user workflow smoother, e.g. tokenizers.</li> <li>Callables prefixed with underscore are considered as helper functions which won’t show up in <a class="reference internal" href="#torch.hub.list" title="torch.hub.list"><code>torch.hub.list()</code></a>.</li> <li>Pretrained weights can either be stored locally in the GitHub repo, or loadable by <a class="reference internal" href="#torch.hub.load_state_dict_from_url" title="torch.hub.load_state_dict_from_url"><code>torch.hub.load_state_dict_from_url()</code></a>. If less than 2GB, it’s recommended to attach it to a <a class="reference external" href="https://help.github.com/en/articles/distributing-large-binaries">project release</a> and use the url from the release. In the example above <code>torchvision.models.resnet.resnet18</code> handles <code>pretrained</code>, alternatively you can put the following logic in the entrypoint definition.</li> </ul> <pre data-language="python">if pretrained:
    # For checkpoint saved in local GitHub repo, e.g. &lt;RELATIVE_PATH_TO_CHECKPOINT&gt;=weights/save.pth
    dirname = os.path.dirname(__file__)
    checkpoint = os.path.join(dirname, &lt;RELATIVE_PATH_TO_CHECKPOINT&gt;)
    state_dict = torch.load(checkpoint)
    model.load_state_dict(state_dict)

    # For checkpoint saved elsewhere
    checkpoint = 'https://download.pytorch.org/models/resnet18-5c106cde.pth'
    model.load_state_dict(torch.hub.load_state_dict_from_url(checkpoint, progress=False))
</pre>   <h3 id="important-notice">Important Notice</h3> <ul class="simple"> <li>The published models should be at least in a branch/tag. It can’t be a random commit.</li> </ul>    <h2 id="loading-models-from-hub">Loading models from Hub</h2> <p>Pytorch Hub provides convenient APIs to explore all available models in hub through <a class="reference internal" href="#torch.hub.list" title="torch.hub.list"><code>torch.hub.list()</code></a>, show docstring and examples through <a class="reference internal" href="#torch.hub.help" title="torch.hub.help"><code>torch.hub.help()</code></a> and load the pre-trained models using <a class="reference internal" href="#torch.hub.load" title="torch.hub.load"><code>torch.hub.load()</code></a>.</p> <dl class="py function" id="module-torch.hub"> <dt class="sig sig-object py" id="torch.hub.list">
<code>torch.hub.list(github, force_reload=False, skip_validation=False, trust_repo=None)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/hub.html#list"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>List all callable entrypoints available in the repo specified by <code>github</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>github</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – a string with format “repo_owner/repo_name[:ref]” with an optional ref (tag or branch). If <code>ref</code> is not specified, the default branch is assumed to be <code>main</code> if it exists, and otherwise <code>master</code>. Example: ‘pytorch/vision:0.10’</li> <li>
<strong>force_reload</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – whether to discard the existing cache and force a fresh download. Default is <code>False</code>.</li> <li>
<strong>skip_validation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – if <code>False</code>, torchhub will check that the branch or commit specified by the <code>github</code> argument properly belongs to the repo owner. This will make requests to the GitHub API; you can specify a non-default GitHub token by setting the <code>GITHUB_TOKEN</code> environment variable. Default is <code>False</code>.</li> <li>
<p><strong>trust_repo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a><em> or </em><em>None</em>) – </p>
<p><code>"check"</code>, <code>True</code>, <code>False</code> or <code>None</code>. This parameter was introduced in v1.12 and helps ensuring that users only run code from repos that they trust.</p> <ul> <li>If <code>False</code>, a prompt will ask the user whether the repo should be trusted.</li> <li>If <code>True</code>, the repo will be added to the trusted list and loaded without requiring explicit confirmation.</li> <li>If <code>"check"</code>, the repo will be checked against the list of trusted repos in the cache. If it is not present in that list, the behaviour will fall back onto the <code>trust_repo=False</code> option.</li> <li>If <code>None</code>: this will raise a warning, inviting the user to set <code>trust_repo</code> to either <code>False</code>, <code>True</code> or <code>"check"</code>. This is only present for backward compatibility and will be removed in v2.0.</li> </ul> <p>Default is <code>None</code> and will eventually change to <code>"check"</code> in v2.0.</p> </li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The available callables entrypoint</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p> </dd> </dl> <h4 class="rubric">Example</h4> <pre data-language="python">&gt;&gt;&gt; entrypoints = torch.hub.list('pytorch/vision', force_reload=True)
</pre> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="torch.hub.help">
<code>torch.hub.help(github, model, force_reload=False, skip_validation=False, trust_repo=None)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/hub.html#help"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Show the docstring of entrypoint <code>model</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>github</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – a string with format &lt;repo_owner/repo_name[:ref]&gt; with an optional ref (a tag or a branch). If <code>ref</code> is not specified, the default branch is assumed to be <code>main</code> if it exists, and otherwise <code>master</code>. Example: ‘pytorch/vision:0.10’</li> <li>
<strong>model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – a string of entrypoint name defined in repo’s <code>hubconf.py</code>
</li> <li>
<strong>force_reload</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – whether to discard the existing cache and force a fresh download. Default is <code>False</code>.</li> <li>
<strong>skip_validation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – if <code>False</code>, torchhub will check that the ref specified by the <code>github</code> argument properly belongs to the repo owner. This will make requests to the GitHub API; you can specify a non-default GitHub token by setting the <code>GITHUB_TOKEN</code> environment variable. Default is <code>False</code>.</li> <li>
<p><strong>trust_repo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a><em> or </em><em>None</em>) – </p>
<p><code>"check"</code>, <code>True</code>, <code>False</code> or <code>None</code>. This parameter was introduced in v1.12 and helps ensuring that users only run code from repos that they trust.</p> <ul> <li>If <code>False</code>, a prompt will ask the user whether the repo should be trusted.</li> <li>If <code>True</code>, the repo will be added to the trusted list and loaded without requiring explicit confirmation.</li> <li>If <code>"check"</code>, the repo will be checked against the list of trusted repos in the cache. If it is not present in that list, the behaviour will fall back onto the <code>trust_repo=False</code> option.</li> <li>If <code>None</code>: this will raise a warning, inviting the user to set <code>trust_repo</code> to either <code>False</code>, <code>True</code> or <code>"check"</code>. This is only present for backward compatibility and will be removed in v2.0.</li> </ul> <p>Default is <code>None</code> and will eventually change to <code>"check"</code> in v2.0.</p> </li> </ul> </dd> </dl> <h4 class="rubric">Example</h4> <pre data-language="python">&gt;&gt;&gt; print(torch.hub.help('pytorch/vision', 'resnet18', force_reload=True))
</pre> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="torch.hub.load">
<code>torch.hub.load(repo_or_dir, model, *args, source='github', trust_repo=None, force_reload=False, verbose=True, skip_validation=False, **kwargs)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/hub.html#load"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Load a model from a github repo or a local directory.</p> <p>Note: Loading a model is the typical use case, but this can also be used to for loading other objects such as tokenizers, loss functions, etc.</p> <p>If <code>source</code> is ‘github’, <code>repo_or_dir</code> is expected to be of the form <code>repo_owner/repo_name[:ref]</code> with an optional ref (a tag or a branch).</p> <p>If <code>source</code> is ‘local’, <code>repo_or_dir</code> is expected to be a path to a local directory.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>repo_or_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – If <code>source</code> is ‘github’, this should correspond to a github repo with format <code>repo_owner/repo_name[:ref]</code> with an optional ref (tag or branch), for example ‘pytorch/vision:0.10’. If <code>ref</code> is not specified, the default branch is assumed to be <code>main</code> if it exists, and otherwise <code>master</code>. If <code>source</code> is ‘local’ then it should be a path to a local directory.</li> <li>
<strong>model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – the name of a callable (entrypoint) defined in the repo/dir’s <code>hubconf.py</code>.</li> <li>
<strong>*args</strong> (<em>optional</em>) – the corresponding args for callable <code>model</code>.</li> <li>
<strong>source</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a><em>, </em><em>optional</em>) – ‘github’ or ‘local’. Specifies how <code>repo_or_dir</code> is to be interpreted. Default is ‘github’.</li> <li>
<p><strong>trust_repo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a><em> or </em><em>None</em>) – </p>
<p><code>"check"</code>, <code>True</code>, <code>False</code> or <code>None</code>. This parameter was introduced in v1.12 and helps ensuring that users only run code from repos that they trust.</p> <ul> <li>If <code>False</code>, a prompt will ask the user whether the repo should be trusted.</li> <li>If <code>True</code>, the repo will be added to the trusted list and loaded without requiring explicit confirmation.</li> <li>If <code>"check"</code>, the repo will be checked against the list of trusted repos in the cache. If it is not present in that list, the behaviour will fall back onto the <code>trust_repo=False</code> option.</li> <li>If <code>None</code>: this will raise a warning, inviting the user to set <code>trust_repo</code> to either <code>False</code>, <code>True</code> or <code>"check"</code>. This is only present for backward compatibility and will be removed in v2.0.</li> </ul> <p>Default is <code>None</code> and will eventually change to <code>"check"</code> in v2.0.</p> </li> <li>
<strong>force_reload</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – whether to force a fresh download of the github repo unconditionally. Does not have any effect if <code>source = 'local'</code>. Default is <code>False</code>.</li> <li>
<strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – If <code>False</code>, mute messages about hitting local caches. Note that the message about first download cannot be muted. Does not have any effect if <code>source = 'local'</code>. Default is <code>True</code>.</li> <li>
<strong>skip_validation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – if <code>False</code>, torchhub will check that the branch or commit specified by the <code>github</code> argument properly belongs to the repo owner. This will make requests to the GitHub API; you can specify a non-default GitHub token by setting the <code>GITHUB_TOKEN</code> environment variable. Default is <code>False</code>.</li> <li>
<strong>**kwargs</strong> (<em>optional</em>) – the corresponding kwargs for callable <code>model</code>.</li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The output of the <code>model</code> callable when called with the given <code>*args</code> and <code>**kwargs</code>.</p> </dd> </dl> <h4 class="rubric">Example</h4> <pre data-language="python">&gt;&gt;&gt; # from a github repo
&gt;&gt;&gt; repo = 'pytorch/vision'
&gt;&gt;&gt; model = torch.hub.load(repo, 'resnet50', weights='ResNet50_Weights.IMAGENET1K_V1')
&gt;&gt;&gt; # from a local directory
&gt;&gt;&gt; path = '/some/local/path/pytorch/vision'
&gt;&gt;&gt; model = torch.hub.load(path, 'resnet50', weights='ResNet50_Weights.DEFAULT')
</pre> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="torch.hub.download_url_to_file">
<code>torch.hub.download_url_to_file(url, dst, hash_prefix=None, progress=True)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/hub.html#download_url_to_file"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Download object at the given URL to a local path.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>url</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – URL of the object to download</li> <li>
<strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – Full path where object will be saved, e.g. <code>/tmp/temporary_file</code>
</li> <li>
<strong>hash_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a><em>, </em><em>optional</em>) – If not None, the SHA256 downloaded file should start with <code>hash_prefix</code>. Default: None</li> <li>
<strong>progress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – whether or not to display a progress bar to stderr Default: True</li> </ul> </dd> </dl> <h4 class="rubric">Example</h4> <pre data-language="python">&gt;&gt;&gt; torch.hub.download_url_to_file('https://s3.amazonaws.com/pytorch/models/resnet18-5c106cde.pth', '/tmp/temporary_file')
</pre> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="torch.hub.load_state_dict_from_url">
<code>torch.hub.load_state_dict_from_url(url, model_dir=None, map_location=None, progress=True, check_hash=False, file_name=None, weights_only=False)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/hub.html#load_state_dict_from_url"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Loads the Torch serialized object at the given URL.</p> <p>If downloaded file is a zip file, it will be automatically decompressed.</p> <p>If the object is already present in <code>model_dir</code>, it’s deserialized and returned. The default value of <code>model_dir</code> is <code>&lt;hub_dir&gt;/checkpoints</code> where <code>hub_dir</code> is the directory returned by <a class="reference internal" href="#torch.hub.get_dir" title="torch.hub.get_dir"><code>get_dir()</code></a>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>url</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – URL of the object to download</li> <li>
<strong>model_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a><em>, </em><em>optional</em>) – directory in which to save the object</li> <li>
<strong>map_location</strong> (<em>optional</em>) – a function or a dict specifying how to remap storage locations (see torch.load)</li> <li>
<strong>progress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – whether or not to display a progress bar to stderr. Default: True</li> <li>
<strong>check_hash</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – If True, the filename part of the URL should follow the naming convention <code>filename-&lt;sha256&gt;.ext</code> where <code>&lt;sha256&gt;</code> is the first eight or more digits of the SHA256 hash of the contents of the file. The hash is used to ensure unique names and to verify the contents of the file. Default: False</li> <li>
<strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a><em>, </em><em>optional</em>) – name for the downloaded file. Filename from <code>url</code> will be used if not set.</li> <li>
<strong>weights_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – If True, only weights will be loaded and no complex pickled objects. Recommended for untrusted sources. See <a class="reference internal" href="generated/torch.load#torch.load" title="torch.load"><code>load()</code></a> for more details.</li> </ul> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)">Dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)">Any</a>]</p> </dd> </dl> <h4 class="rubric">Example</h4> <pre data-language="python">&gt;&gt;&gt; state_dict = torch.hub.load_state_dict_from_url('https://s3.amazonaws.com/pytorch/models/resnet18-5c106cde.pth')
</pre> </dd>
</dl>  <h3 id="running-a-loaded-model">Running a loaded model:</h3> <p>Note that <code>*args</code> and <code>**kwargs</code> in <a class="reference internal" href="#torch.hub.load" title="torch.hub.load"><code>torch.hub.load()</code></a> are used to <strong>instantiate</strong> a model. After you have loaded a model, how can you find out what you can do with the model? A suggested workflow is</p> <ul class="simple"> <li>
<code>dir(model)</code> to see all available methods of the model.</li> <li>
<code>help(model.foo)</code> to check what arguments <code>model.foo</code> takes to run</li> </ul> <p>To help users explore without referring to documentation back and forth, we strongly recommend repo owners make function help messages clear and succinct. It’s also helpful to include a minimal working example.</p>   <h3 id="where-are-my-downloaded-models-saved">Where are my downloaded models saved?</h3> <p>The locations are used in the order of</p> <ul class="simple"> <li>Calling <code>hub.set_dir(&lt;PATH_TO_HUB_DIR&gt;)</code>
</li> <li>
<code>$TORCH_HOME/hub</code>, if environment variable <code>TORCH_HOME</code> is set.</li> <li>
<code>$XDG_CACHE_HOME/torch/hub</code>, if environment variable <code>XDG_CACHE_HOME</code> is set.</li> <li><code>~/.cache/torch/hub</code></li> </ul> <dl class="py function"> <dt class="sig sig-object py" id="torch.hub.get_dir">
<code>torch.hub.get_dir()</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/hub.html#get_dir"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Get the Torch Hub cache directory used for storing downloaded models &amp; weights.</p> <p>If <a class="reference internal" href="#torch.hub.set_dir" title="torch.hub.set_dir"><code>set_dir()</code></a> is not called, default path is <code>$TORCH_HOME/hub</code> where environment variable <code>$TORCH_HOME</code> defaults to <code>$XDG_CACHE_HOME/torch</code>. <code>$XDG_CACHE_HOME</code> follows the X Design Group specification of the Linux filesystem layout, with a default value <code>~/.cache</code> if the environment variable is not set.</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="torch.hub.set_dir">
<code>torch.hub.set_dir(d)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/hub.html#set_dir"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Optionally set the Torch Hub directory used to save downloaded models &amp; weights.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>d</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – path to a local folder to save downloaded models &amp; weights.</p> </dd> </dl> </dd>
</dl>   <h3 id="caching-logic">Caching logic</h3> <p>By default, we don’t clean up files after loading it. Hub uses the cache by default if it already exists in the directory returned by <a class="reference internal" href="#torch.hub.get_dir" title="torch.hub.get_dir"><code>get_dir()</code></a>.</p> <p>Users can force a reload by calling <code>hub.load(..., force_reload=True)</code>. This will delete the existing GitHub folder and downloaded weights, reinitialize a fresh download. This is useful when updates are published to the same branch, users can keep up with the latest release.</p>   <h3 id="known-limitations">Known limitations:</h3> <p>Torch hub works by importing the package as if it was installed. There are some side effects introduced by importing in Python. For example, you can see new items in Python caches <code>sys.modules</code> and <code>sys.path_importer_cache</code> which is normal Python behavior. This also means that you may have import errors when importing different models from different repos, if the repos have the same sub-package names (typically, a <code>model</code> subpackage). A workaround for these kinds of import errors is to remove the offending sub-package from the <code>sys.modules</code> dict; more details can be found in <a class="reference external" href="https://github.com/pytorch/hub/issues/243#issuecomment-942403391">this GitHub issue</a>.</p> <p>A known limitation that is worth mentioning here: users <strong>CANNOT</strong> load two different branches of the same repo in the <strong>same python process</strong>. It’s just like installing two packages with the same name in Python, which is not good. Cache might join the party and give you surprises if you actually try that. Of course it’s totally fine to load them in separate processes.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/hub.html" class="_attribution-link">https://pytorch.org/docs/2.1/hub.html</a>
  </p>
</div>
