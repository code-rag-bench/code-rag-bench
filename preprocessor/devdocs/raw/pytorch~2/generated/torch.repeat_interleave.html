<h1 id="torch-repeat-interleave">torch.repeat_interleave</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.repeat_interleave">
<code>torch.repeat_interleave(input, repeats, dim=None, *, output_size=None) → Tensor</code> </dt> <dd>
<p>Repeat elements of a tensor.</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>This is different from <a class="reference internal" href="torch.tensor.repeat#torch.Tensor.repeat" title="torch.Tensor.repeat"><code>torch.Tensor.repeat()</code></a> but similar to <code>numpy.repeat</code>.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>input</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – the input tensor.</li> <li>
<strong>repeats</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a>) – The number of repetitions for each element. repeats is broadcasted to fit the shape of the given axis.</li> <li>
<strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a><em>, </em><em>optional</em>) – The dimension along which to repeat values. By default, use the flattened input array, and return a flat output array.</li> </ul> </dd> <dt class="field-even">Keyword Arguments</dt> <dd class="field-even">
<p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a><em>, </em><em>optional</em>) – Total output size for the given axis ( e.g. sum of repeats). If given, it will avoid stream synchronization needed to calculate output shape of the tensor.</p> </dd> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>Repeated tensor which has the same shape as input, except along the given axis.</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a></p> </dd> </dl> <p>Example:</p> <pre data-language="python">&gt;&gt;&gt; x = torch.tensor([1, 2, 3])
&gt;&gt;&gt; x.repeat_interleave(2)
tensor([1, 1, 2, 2, 3, 3])
&gt;&gt;&gt; y = torch.tensor([[1, 2], [3, 4]])
&gt;&gt;&gt; torch.repeat_interleave(y, 2)
tensor([1, 1, 2, 2, 3, 3, 4, 4])
&gt;&gt;&gt; torch.repeat_interleave(y, 3, dim=1)
tensor([[1, 1, 1, 2, 2, 2],
        [3, 3, 3, 4, 4, 4]])
&gt;&gt;&gt; torch.repeat_interleave(y, torch.tensor([1, 2]), dim=0)
tensor([[1, 2],
        [3, 4],
        [3, 4]])
&gt;&gt;&gt; torch.repeat_interleave(y, torch.tensor([1, 2]), dim=0, output_size=3)
tensor([[1, 2],
        [3, 4],
        [3, 4]])
</pre> <p>If the <code>repeats</code> is <code>tensor([n1, n2, n3, …])</code>, then the output will be <code>tensor([0, 0, …, 1, 1, …, 2, 2, …, …])</code> where <code>0</code> appears <code>n1</code> times, <code>1</code> appears <code>n2</code> times, <code>2</code> appears <code>n3</code> times, etc.</p> <dl class="py function"> <dt class="sig sig-object py"> <span class="sig-prename descclassname">torch.</span><span class="sig-name descname">repeat_interleave</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">repeats</span></em>, <em class="sig-param"><span class="n">*</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a></span></span>
</dt> 
</dl> <p>Repeats 0 repeats[0] times, 1 repeats[1] times, 2 repeats[2] times, etc.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>repeats</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – The number of repetitions for each element.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Repeated tensor of size <code>sum(repeats)</code>.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a></p> </dd> </dl> <p>Example:</p> <pre data-language="python">&gt;&gt;&gt; torch.repeat_interleave(torch.tensor([1, 2, 3]))
tensor([0, 1, 1, 2, 2, 2])
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.repeat_interleave.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.repeat_interleave.html</a>
  </p>
</div>
