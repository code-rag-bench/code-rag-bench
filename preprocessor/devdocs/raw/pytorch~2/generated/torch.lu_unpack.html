<h1 id="torch-lu-unpack">torch.lu_unpack</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.lu_unpack">
<code>torch.lu_unpack(LU_data, LU_pivots, unpack_data=True, unpack_pivots=True, *, out=None)</code> </dt> <dd>
<p>Unpacks the LU decomposition returned by <a class="reference internal" href="torch.linalg.lu_factor#torch.linalg.lu_factor" title="torch.linalg.lu_factor"><code>lu_factor()</code></a> into the <code>P, L, U</code> matrices.</p> <div class="admonition seealso"> <p class="admonition-title">See also</p> <p><a class="reference internal" href="torch.linalg.lu#torch.linalg.lu" title="torch.linalg.lu"><code>lu()</code></a> returns the matrices from the LU decomposition. Its gradient formula is more efficient than that of doing <a class="reference internal" href="torch.linalg.lu_factor#torch.linalg.lu_factor" title="torch.linalg.lu_factor"><code>lu_factor()</code></a> followed by <code>lu_unpack()</code>.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>LU_data</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – the packed LU factorization data</li> <li>
<strong>LU_pivots</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – the packed LU factorization pivots</li> <li>
<strong>unpack_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a>) – flag indicating if the data should be unpacked. If <code>False</code>, then the returned <code>L</code> and <code>U</code> are empty tensors. Default: <code>True</code>
</li> <li>
<strong>unpack_pivots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a>) – flag indicating if the pivots should be unpacked into a permutation matrix <code>P</code>. If <code>False</code>, then the returned <code>P</code> is an empty tensor. Default: <code>True</code>
</li> </ul> </dd> <dt class="field-even">Keyword Arguments</dt> <dd class="field-even">
<p><strong>out</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a><em>, </em><em>optional</em>) – output tuple of three tensors. Ignored if <code>None</code>.</p> </dd> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A namedtuple <code>(P, L, U)</code></p> </dd> </dl> <p>Examples:</p> <pre data-language="python">&gt;&gt;&gt; A = torch.randn(2, 3, 3)
&gt;&gt;&gt; LU, pivots = torch.linalg.lu_factor(A)
&gt;&gt;&gt; P, L, U = torch.lu_unpack(LU, pivots)
&gt;&gt;&gt; # We can recover A from the factorization
&gt;&gt;&gt; A_ = P @ L @ U
&gt;&gt;&gt; torch.allclose(A, A_)
True

&gt;&gt;&gt; # LU factorization of a rectangular matrix:
&gt;&gt;&gt; A = torch.randn(2, 3, 2)
&gt;&gt;&gt; LU, pivots = torch.linalg.lu_factor(A)
&gt;&gt;&gt; P, L, U = torch.lu_unpack(LU, pivots)
&gt;&gt;&gt; # P, L, U are the same as returned by linalg.lu
&gt;&gt;&gt; P_, L_, U_ = torch.linalg.lu(A)
&gt;&gt;&gt; torch.allclose(P, P_) and torch.allclose(L, L_) and torch.allclose(U, U_)
True
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.lu_unpack.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.lu_unpack.html</a>
  </p>
</div>
