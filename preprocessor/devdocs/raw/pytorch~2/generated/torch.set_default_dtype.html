<h1 id="torch-set-default-dtype">torch.set_default_dtype</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.set_default_dtype">
<code>torch.set_default_dtype(d)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch.html#set_default_dtype"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Sets the default floating point dtype to <code>d</code>. Supports torch.float32 and torch.float64 as inputs. Other dtypes may be accepted without complaint but are not supported and are unlikely to work as expected.</p> <p>When PyTorch is initialized its default floating point dtype is torch.float32, and the intent of set_default_dtype(torch.float64) is to facilitate NumPy-like type inference. The default floating point dtype is used to:</p> <ol class="arabic simple"> <li>Implicitly determine the default complex dtype. When the default floating point type is float32 the default complex dtype is complex64, and when the default floating point type is float64 the default complex type is complex128.</li> <li>Infer the dtype for tensors constructed using Python floats or complex Python numbers. See examples below.</li> <li>Determine the result of type promotion between bool and integer tensors and Python floats and complex Python numbers.</li> </ol> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>d</strong> (<a class="reference internal" href="../tensor_attributes#torch.dtype" title="torch.dtype"><code>torch.dtype</code></a>) â€“ the floating point dtype to make the default. Either torch.float32 or torch.float64.</p> </dd> </dl> <h4 class="rubric">Example</h4> <pre data-language="python">&gt;&gt;&gt; # initial default for floating point is torch.float32
&gt;&gt;&gt; # Python floats are interpreted as float32
&gt;&gt;&gt; torch.tensor([1.2, 3]).dtype
torch.float32
&gt;&gt;&gt; # initial default for floating point is torch.complex64
&gt;&gt;&gt; # Complex Python numbers are interpreted as complex64
&gt;&gt;&gt; torch.tensor([1.2, 3j]).dtype
torch.complex64
</pre> <pre data-language="python">&gt;&gt;&gt; torch.set_default_dtype(torch.float64)
</pre> <pre data-language="python">&gt;&gt;&gt; # Python floats are now interpreted as float64
&gt;&gt;&gt; torch.tensor([1.2, 3]).dtype    # a new floating point tensor
torch.float64
&gt;&gt;&gt; # Complex Python numbers are now interpreted as complex128
&gt;&gt;&gt; torch.tensor([1.2, 3j]).dtype   # a new complex tensor
torch.complex128
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.set_default_dtype.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.set_default_dtype.html</a>
  </p>
</div>
