<h1 id="torch-triangular-solve">torch.triangular_solve</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.triangular_solve">
<code>torch.triangular_solve(b, A, upper=True, transpose=False, unitriangular=False, *, out=None)</code> </dt> <dd>
<p>Solves a system of equations with a square upper or lower triangular invertible matrix <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span></span></span> and multiple right-hand sides <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span></span></span>.</p> <p>In symbols, it solves <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>X</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">AX = b</annotation></semantics></math></span></span></span> and assumes <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span></span></span> is square upper-triangular (or lower-triangular if <code>upper</code><code>= False</code>) and does not have zeros on the diagonal.</p> <p><code>torch.triangular_solve(b, A)</code> can take in 2D inputs <code>b, A</code> or inputs that are batches of 2D matrices. If the inputs are batches, then returns batched outputs <code>X</code></p> <p>If the diagonal of <code>A</code> contains zeros or elements that are very close to zero and <code>unitriangular</code><code>= False</code> (default) or if the input matrix is badly conditioned, the result may contain <code>NaN</code> s.</p> <p>Supports input of float, double, cfloat and cdouble data types.</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p><a class="reference internal" href="#torch.triangular_solve" title="torch.triangular_solve"><code>torch.triangular_solve()</code></a> is deprecated in favor of <a class="reference internal" href="torch.linalg.solve_triangular#torch.linalg.solve_triangular" title="torch.linalg.solve_triangular"><code>torch.linalg.solve_triangular()</code></a> and will be removed in a future PyTorch release. <a class="reference internal" href="torch.linalg.solve_triangular#torch.linalg.solve_triangular" title="torch.linalg.solve_triangular"><code>torch.linalg.solve_triangular()</code></a> has its arguments reversed and does not return a copy of one of the inputs.</p> <p><code>X = torch.triangular_solve(B, A).solution</code> should be replaced with</p> <pre data-language="python">X = torch.linalg.solve_triangular(A, B)
</pre> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>b</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – multiple right-hand sides of size <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>∗</mo><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(*, m, k)</annotation></semantics></math></span></span></span> where <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span></span></span> is zero of more batch dimensions</li> <li>
<strong>A</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – the input triangular coefficient matrix of size <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>∗</mo><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(*, m, m)</annotation></semantics></math></span></span></span> where <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span></span></span> is zero or more batch dimensions</li> <li>
<strong>upper</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – whether <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span></span></span> is upper or lower triangular. Default: <code>True</code>.</li> <li>
<strong>transpose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – solves <code>op(A)X = b</code> where <code>op(A) = A^T</code> if this flag is <code>True</code>, and <code>op(A) = A</code> if it is <code>False</code>. Default: <code>False</code>.</li> <li>
<strong>unitriangular</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – whether <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span></span></span> is unit triangular. If True, the diagonal elements of <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span></span></span> are assumed to be 1 and not referenced from <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span></span></span>. Default: <code>False</code>.</li> </ul> </dd> <dt class="field-even">Keyword Arguments</dt> <dd class="field-even">
<p><strong>out</strong> (<em>(</em><a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em>, </em><a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em>)</em><em>, </em><em>optional</em>) – tuple of two tensors to write the output to. Ignored if <code>None</code>. Default: <code>None</code>.</p> </dd> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A namedtuple <code>(solution, cloned_coefficient)</code> where <code>cloned_coefficient</code> is a clone of <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span></span></span> and <code>solution</code> is the solution <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span></span></span> to <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>X</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">AX = b</annotation></semantics></math></span></span></span> (or whatever variant of the system of equations, depending on the keyword arguments.)</p> </dd> </dl> <p>Examples:</p> <pre data-language="python">&gt;&gt;&gt; A = torch.randn(2, 2).triu()
&gt;&gt;&gt; A
tensor([[ 1.1527, -1.0753],
        [ 0.0000,  0.7986]])
&gt;&gt;&gt; b = torch.randn(2, 3)
&gt;&gt;&gt; b
tensor([[-0.0210,  2.3513, -1.5492],
        [ 1.5429,  0.7403, -1.0243]])
&gt;&gt;&gt; torch.triangular_solve(b, A)
torch.return_types.triangular_solve(
solution=tensor([[ 1.7841,  2.9046, -2.5405],
        [ 1.9320,  0.9270, -1.2826]]),
cloned_coefficient=tensor([[ 1.1527, -1.0753],
        [ 0.0000,  0.7986]]))
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.triangular_solve.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.triangular_solve.html</a>
  </p>
</div>
