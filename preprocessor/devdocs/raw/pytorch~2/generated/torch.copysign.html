<h1 id="torch-copysign">torch.copysign</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.copysign">
<code>torch.copysign(input, other, *, out=None) → Tensor</code> </dt> <dd>
<p>Create a new floating-point tensor with the magnitude of <code>input</code> and the sign of <code>other</code>, elementwise.</p> <div class="math"> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>out</mtext><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi mathvariant="normal">∣</mi><msub><mtext>input</mtext><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><msub><mtext>other</mtext><mi>i</mi></msub><mo>≤</mo><mo>−</mo><mn>0.0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">∣</mi><msub><mtext>input</mtext><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><msub><mtext>other</mtext><mi>i</mi></msub><mo>≥</mo><mn>0.0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{out}_{i} = \begin{cases} -|\text{input}_{i}| &amp; \text{if } \text{other}_{i} \leq -0.0 \\ |\text{input}_{i}| &amp; \text{if } \text{other}_{i} \geq 0.0 \\ \end{cases} </annotation></semantics></math></span></span></span>
</div>
<p>Supports <a class="reference internal" href="https://pytorch.org/docs/2.1/notes/broadcasting.html#broadcasting-semantics"><span class="std std-ref">broadcasting to a common shape</span></a>, and integer and float inputs.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>input</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – magnitudes.</li> <li>
<strong>other</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em> or </em><em>Number</em>) – contains value(s) whose signbit(s) are applied to the magnitudes in <code>input</code>.</li> </ul> </dd> <dt class="field-even">Keyword Arguments</dt> <dd class="field-even">
<p><strong>out</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em>, </em><em>optional</em>) – the output tensor.</p> </dd> </dl> <p>Example:</p> <pre data-language="python">&gt;&gt;&gt; a = torch.randn(5)
&gt;&gt;&gt; a
tensor([-1.2557, -0.0026, -0.5387,  0.4740, -0.9244])
&gt;&gt;&gt; torch.copysign(a, 1)
tensor([1.2557, 0.0026, 0.5387, 0.4740, 0.9244])
&gt;&gt;&gt; a = torch.randn(4, 4)
&gt;&gt;&gt; a
tensor([[ 0.7079,  0.2778, -1.0249,  0.5719],
        [-0.0059, -0.2600, -0.4475, -1.3948],
        [ 0.3667, -0.9567, -2.5757, -0.1751],
        [ 0.2046, -0.0742,  0.2998, -0.1054]])
&gt;&gt;&gt; b = torch.randn(4)
tensor([ 0.2373,  0.3120,  0.3190, -1.1128])
&gt;&gt;&gt; torch.copysign(a, b)
tensor([[ 0.7079,  0.2778,  1.0249, -0.5719],
        [ 0.0059,  0.2600,  0.4475, -1.3948],
        [ 0.3667,  0.9567,  2.5757, -0.1751],
        [ 0.2046,  0.0742,  0.2998, -0.1054]])
&gt;&gt;&gt; a = torch.tensor([1.])
&gt;&gt;&gt; b = torch.tensor([-0.])
&gt;&gt;&gt; torch.copysign(a, b)
tensor([-1.])
</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>copysign handles signed zeros. If the other argument has a negative zero (-0), the corresponding output value will be negative.</p> </div> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.copysign.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.copysign.html</a>
  </p>
</div>
