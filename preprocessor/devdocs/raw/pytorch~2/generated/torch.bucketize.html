<h1 id="torch-bucketize">torch.bucketize</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.bucketize">
<code>torch.bucketize(input, boundaries, *, out_int32=False, right=False, out=None) → Tensor</code> </dt> <dd>
<p>Returns the indices of the buckets to which each value in the <code>input</code> belongs, where the boundaries of the buckets are set by <code>boundaries</code>. Return a new tensor with the same size as <code>input</code>. If <code>right</code> is False (default), then the left boundary is open. Note that this behavior is opposite the behavior of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.digitize.html">numpy.digitize</a>. More formally, the returned index satisfies the following rules:</p> <table class="colwidths-given docutils colwidths-auto align-default">  <thead> <tr>
<th class="head"><p><code>right</code></p></th> <th class="head"><p><em>returned index satisfies</em></p></th> </tr> </thead>  <tr>
<td><p>False</p></td> <td><p><code>boundaries[i-1] &lt; input[m][n]...[l][x] &lt;= boundaries[i]</code></p></td> </tr> <tr>
<td><p>True</p></td> <td><p><code>boundaries[i-1] &lt;= input[m][n]...[l][x] &lt; boundaries[i]</code></p></td> </tr>  </table> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>input</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em> or </em><em>Scalar</em>) – N-D tensor or a Scalar containing the search value(s).</li> <li>
<strong>boundaries</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a>) – 1-D tensor, must contain a strictly increasing sequence, or the return value is undefined.</li> </ul> </dd> <dt class="field-even">Keyword Arguments</dt> <dd class="field-even">
<ul class="simple"> <li>
<strong>out_int32</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – indicate the output data type. torch.int32 if True, torch.int64 otherwise. Default value is False, i.e. default output data type is torch.int64.</li> <li>
<strong>right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – if False, return the first suitable location that is found. If True, return the last such index. If no suitable index found, return 0 for non-numerical value (eg. nan, inf) or the size of <code>boundaries</code> (one pass the last index). In other words, if False, gets the lower bound index for each value in <code>input</code> from <code>boundaries</code>. If True, gets the upper bound index instead. Default value is False.</li> <li>
<strong>out</strong> (<a class="reference internal" href="../tensors#torch.Tensor" title="torch.Tensor">Tensor</a><em>, </em><em>optional</em>) – the output tensor, must be the same size as <code>input</code> if provided.</li> </ul> </dd> </dl> <p>Example:</p> <pre data-language="python">&gt;&gt;&gt; boundaries = torch.tensor([1, 3, 5, 7, 9])
&gt;&gt;&gt; boundaries
tensor([1, 3, 5, 7, 9])
&gt;&gt;&gt; v = torch.tensor([[3, 6, 9], [3, 6, 9]])
&gt;&gt;&gt; v
tensor([[3, 6, 9],
        [3, 6, 9]])
&gt;&gt;&gt; torch.bucketize(v, boundaries)
tensor([[1, 3, 4],
        [1, 3, 4]])
&gt;&gt;&gt; torch.bucketize(v, boundaries, right=True)
tensor([[2, 3, 5],
        [2, 3, 5]])
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.bucketize.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.bucketize.html</a>
  </p>
</div>
