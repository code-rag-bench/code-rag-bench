<h1 id="torch-empty-strided">torch.empty_strided</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.empty_strided">
<code>torch.empty_strided(size, stride, *, dtype=None, layout=None, device=None, requires_grad=False, pin_memory=False) → Tensor</code> </dt> <dd>
<p>Creates a tensor with the specified <code>size</code> and <code>stride</code> and filled with undefined data.</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>If the constructed tensor is “overlapped” (with multiple indices referring to the same element in memory) its behavior is undefined.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If <a class="reference internal" href="torch.use_deterministic_algorithms#torch.use_deterministic_algorithms" title="torch.use_deterministic_algorithms"><code>torch.use_deterministic_algorithms()</code></a> is set to <code>True</code>, the output tensor is initialized to prevent any possible nondeterministic behavior from using the data as an input to an operation. Floating point and complex tensors are filled with NaN, and integer tensors are filled with the maximum value.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a>) – the shape of the output tensor</li> <li>
<strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a>) – the strides of the output tensor</li> </ul> </dd> <dt class="field-even">Keyword Arguments</dt> <dd class="field-even">
<ul class="simple"> <li>
<strong>dtype</strong> (<a class="reference internal" href="../tensor_attributes#torch.dtype" title="torch.dtype"><code>torch.dtype</code></a>, optional) – the desired data type of returned tensor. Default: if <code>None</code>, uses a global default (see <a class="reference internal" href="torch.set_default_tensor_type#torch.set_default_tensor_type" title="torch.set_default_tensor_type"><code>torch.set_default_tensor_type()</code></a>).</li> <li>
<strong>layout</strong> (<a class="reference internal" href="../tensor_attributes#torch.layout" title="torch.layout"><code>torch.layout</code></a>, optional) – the desired layout of returned Tensor. Default: <code>torch.strided</code>.</li> <li>
<strong>device</strong> (<a class="reference internal" href="../tensor_attributes#torch.device" title="torch.device"><code>torch.device</code></a>, optional) – the desired device of returned tensor. Default: if <code>None</code>, uses the current device for the default tensor type (see <a class="reference internal" href="torch.set_default_tensor_type#torch.set_default_tensor_type" title="torch.set_default_tensor_type"><code>torch.set_default_tensor_type()</code></a>). <a class="reference internal" href="../tensor_attributes#torch.device" title="torch.device"><code>device</code></a> will be the CPU for CPU tensor types and the current CUDA device for CUDA tensor types.</li> <li>
<strong>requires_grad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – If autograd should record operations on the returned tensor. Default: <code>False</code>.</li> <li>
<strong>pin_memory</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – If set, returned tensor would be allocated in the pinned memory. Works only for CPU tensors. Default: <code>False</code>.</li> </ul> </dd> </dl> <p>Example:</p> <pre data-language="python">&gt;&gt;&gt; a = torch.empty_strided((2, 3), (1, 2))
&gt;&gt;&gt; a
tensor([[8.9683e-44, 4.4842e-44, 5.1239e+07],
        [0.0000e+00, 0.0000e+00, 3.0705e-41]])
&gt;&gt;&gt; a.stride()
(1, 2)
&gt;&gt;&gt; a.size()
torch.Size([2, 3])
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.empty_strided.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.empty_strided.html</a>
  </p>
</div>
