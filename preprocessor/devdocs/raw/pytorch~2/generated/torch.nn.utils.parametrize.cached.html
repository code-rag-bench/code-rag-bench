<h1 id="torch-nn-utils-parametrize-cached">torch.nn.utils.parametrize.cached</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.nn.utils.parametrize.cached">
<code>torch.nn.utils.parametrize.cached()</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/utils/parametrize.html#cached"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Context manager that enables the caching system within parametrizations registered with <a class="reference internal" href="torch.nn.utils.parametrize.register_parametrization#torch.nn.utils.parametrize.register_parametrization" title="torch.nn.utils.parametrize.register_parametrization"><code>register_parametrization()</code></a>.</p> <p>The value of the parametrized objects is computed and cached the first time they are required when this context manager is active. The cached values are discarded when leaving the context manager.</p> <p>This is useful when using a parametrized parameter more than once in the forward pass. An example of this is when parametrizing the recurrent kernel of an RNN or when sharing weights.</p> <p>The simplest way to activate the cache is by wrapping the forward pass of the neural network</p> <pre data-language="python">import torch.nn.utils.parametrize as P
...
with P.cached():
    output = model(inputs)
</pre> <p>in training and evaluation. One may also wrap the parts of the modules that use several times the parametrized tensors. For example, the loop of an RNN with a parametrized recurrent kernel:</p> <pre data-language="python">with P.cached():
    for x in xs:
        out_rnn = self.rnn_cell(x, out_rnn)
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.nn.utils.parametrize.cached.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.nn.utils.parametrize.cached.html</a>
  </p>
</div>
