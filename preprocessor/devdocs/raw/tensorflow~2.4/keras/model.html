<h1 class="devsite-page-title">tf.keras.Model</h1>      <table class="tfo-notebook-buttons tfo-api nocontent" align="left">  <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L138-L2675">  View source on GitHub </a> </td> </table> <p><code translate="no" dir="ltr">Model</code> groups layers into an object with training and inference features.</p> <p>Inherits From: <a href="layers/layer"><code translate="no" dir="ltr">Layer</code></a>, <a href="../module"><code translate="no" dir="ltr">Module</code></a></p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases">View aliases</h4> <p> <b>Main aliases</b> </p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"><code translate="no" dir="ltr">tf.keras.models.Model</code></a></p> <b>Compat aliases for migration</b> <p>See <a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for more details.</p> <p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"><code translate="no" dir="ltr">tf.compat.v1.keras.Model</code></a>, <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"><code translate="no" dir="ltr">tf.compat.v1.keras.models.Model</code></a></p> </section> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
tf.keras.Model(
    *args, **kwargs
)
</pre>   
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">inputs</code> </td> <td> The input(s) of the model: a <a href="input"><code translate="no" dir="ltr">keras.Input</code></a> object or list of <a href="input"><code translate="no" dir="ltr">keras.Input</code></a> objects. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">outputs</code> </td> <td> The output(s) of the model. See Functional API example below. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">name</code> </td> <td> String, the name of the model. </td> </tr> </table> <p>There are two ways to instantiate a <code translate="no" dir="ltr">Model</code>:</p> <p>1 - With the "Functional API", where you start from <code translate="no" dir="ltr">Input</code>, you chain layer calls to specify the model's forward pass, and finally you create your model from inputs and outputs:</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">import tensorflow as tf

inputs = tf.keras.Input(shape=(3,))
x = tf.keras.layers.Dense(4, activation=tf.nn.relu)(inputs)
outputs = tf.keras.layers.Dense(5, activation=tf.nn.softmax)(x)
model = tf.keras.Model(inputs=inputs, outputs=outputs)
</pre> <p>2 - By subclassing the <code translate="no" dir="ltr">Model</code> class: in that case, you should define your layers in <code translate="no" dir="ltr">__init__</code> and you should implement the model's forward pass in <code translate="no" dir="ltr">call</code>.</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">import tensorflow as tf

class MyModel(tf.keras.Model):

  def __init__(self):
    super(MyModel, self).__init__()
    self.dense1 = tf.keras.layers.Dense(4, activation=tf.nn.relu)
    self.dense2 = tf.keras.layers.Dense(5, activation=tf.nn.softmax)

  def call(self, inputs):
    x = self.dense1(inputs)
    return self.dense2(x)

model = MyModel()
</pre> <p>If you subclass <code translate="no" dir="ltr">Model</code>, you can optionally have a <code translate="no" dir="ltr">training</code> argument (boolean) in <code translate="no" dir="ltr">call</code>, which you can use to specify a different behavior in training and inference:</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">import tensorflow as tf

class MyModel(tf.keras.Model):

  def __init__(self):
    super(MyModel, self).__init__()
    self.dense1 = tf.keras.layers.Dense(4, activation=tf.nn.relu)
    self.dense2 = tf.keras.layers.Dense(5, activation=tf.nn.softmax)
    self.dropout = tf.keras.layers.Dropout(0.5)

  def call(self, inputs, training=False):
    x = self.dense1(inputs)
    if training:
      x = self.dropout(x, training=training)
    return self.dense2(x)

model = MyModel()
</pre> <p>Once the model is created, you can config the model with losses and metrics with <code translate="no" dir="ltr">model.compile()</code>, train the model with <code translate="no" dir="ltr">model.fit()</code>, or use the model to do prediction with <code translate="no" dir="ltr">model.predict()</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">distribute_strategy</code> </td> <td> The <a href="../distribute/strategy"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> this model was created under. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">layers</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">metrics_names</code> </td> <td> Returns the model's display labels for all outputs. <blockquote class="note">
<strong>Note:</strong><span> <code translate="no" dir="ltr">metrics_names</code> are available only after a <a href="model"><code translate="no" dir="ltr">keras.Model</code></a> has been trained/evaluated on actual data.</span>
</blockquote> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
inputs = tf.keras.layers.Input(shape=(3,))
outputs = tf.keras.layers.Dense(2)(inputs)
model = tf.keras.models.Model(inputs=inputs, outputs=outputs)
model.compile(optimizer="Adam", loss="mse", metrics=["mae"])
model.metrics_names
[]
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
x = np.random.random((2, 3))
y = np.random.randint(0, 2, (2, 2))
model.fit(x, y)
model.metrics_names
['loss', 'mae']
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
inputs = tf.keras.layers.Input(shape=(3,))
d = tf.keras.layers.Dense(2, name='out')
output_1 = d(inputs)
output_2 = d(inputs)
model = tf.keras.models.Model(
   inputs=inputs, outputs=[output_1, output_2])
model.compile(optimizer="Adam", loss="mse", metrics=["mae", "acc"])
model.fit(x, (y, y))
model.metrics_names
['loss', 'out_loss', 'out_1_loss', 'out_mae', 'out_acc', 'out_1_mae',
'out_1_acc']
</pre> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">run_eagerly</code> </td> <td> Settable attribute indicating whether the model should run eagerly. <p>Running eagerly means that your model will be run step by step, like Python code. Your model might run slower, but it should become easier for you to debug it by stepping into individual layer calls.</p> <p>By default, we will attempt to compile your model to a static graph to deliver the best execution performance. </p>
</td> </tr> </table> <h2 id="methods" data-text="Methods">Methods</h2> <h3 id="compile" data-text="compile"><code translate="no" dir="ltr">compile</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L449-L549">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
compile(
    optimizer='rmsprop', loss=None, metrics=None, loss_weights=None,
    weighted_metrics=None, run_eagerly=None, steps_per_execution=None, **kwargs
)
</pre> <p>Configures the model for training.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">optimizer</code> </td> <td> String (name of optimizer) or optimizer instance. See <a href="optimizers"><code translate="no" dir="ltr">tf.keras.optimizers</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">loss</code> </td> <td> String (name of objective function), objective function or <a href="losses/loss"><code translate="no" dir="ltr">tf.keras.losses.Loss</code></a> instance. See <a href="losses"><code translate="no" dir="ltr">tf.keras.losses</code></a>. An objective function is any callable with the signature <code translate="no" dir="ltr">loss = fn(y_true, y_pred)</code>, where y_true = ground truth values with shape = <code translate="no" dir="ltr">[batch_size, d0, .. dN]</code>, except sparse loss functions such as sparse categorical crossentropy where shape = <code translate="no" dir="ltr">[batch_size, d0, .. dN-1]</code>. y_pred = predicted values with shape = <code translate="no" dir="ltr">[batch_size, d0, .. dN]</code>. It returns a weighted loss float tensor. If a custom <code translate="no" dir="ltr">Loss</code> instance is used and reduction is set to NONE, return value has the shape [batch_size, d0, .. dN-1] ie. per-sample or per-timestep loss values; otherwise, it is a scalar. If the model has multiple outputs, you can use a different loss on each output by passing a dictionary or a list of losses. The loss value that will be minimized by the model will then be the sum of all individual losses. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">metrics</code> </td> <td> List of metrics to be evaluated by the model during training and testing. Each of this can be a string (name of a built-in function), function or a <a href="metrics/metric"><code translate="no" dir="ltr">tf.keras.metrics.Metric</code></a> instance. See <a href="metrics"><code translate="no" dir="ltr">tf.keras.metrics</code></a>. Typically you will use <code translate="no" dir="ltr">metrics=['accuracy']</code>. A function is any callable with the signature <code translate="no" dir="ltr">result = fn(y_true, y_pred)</code>. To specify different metrics for different outputs of a multi-output model, you could also pass a dictionary, such as <code translate="no" dir="ltr">metrics={'output_a': 'accuracy', 'output_b': ['accuracy', 'mse']}</code>. You can also pass a list (len = len(outputs)) of lists of metrics such as <code translate="no" dir="ltr">metrics=[['accuracy'], ['accuracy', 'mse']]</code> or <code translate="no" dir="ltr">metrics=['accuracy', ['accuracy', 'mse']]</code>. When you pass the strings 'accuracy' or 'acc', we convert this to one of <a href="metrics/binaryaccuracy"><code translate="no" dir="ltr">tf.keras.metrics.BinaryAccuracy</code></a>, <a href="metrics/categoricalaccuracy"><code translate="no" dir="ltr">tf.keras.metrics.CategoricalAccuracy</code></a>, <a href="metrics/sparsecategoricalaccuracy"><code translate="no" dir="ltr">tf.keras.metrics.SparseCategoricalAccuracy</code></a> based on the loss function used and the model output shape. We do a similar conversion for the strings 'crossentropy' and 'ce' as well. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">loss_weights</code> </td> <td> Optional list or dictionary specifying scalar coefficients (Python floats) to weight the loss contributions of different model outputs. The loss value that will be minimized by the model will then be the <em>weighted sum</em> of all individual losses, weighted by the <code translate="no" dir="ltr">loss_weights</code> coefficients. If a list, it is expected to have a 1:1 mapping to the model's outputs. If a dict, it is expected to map output names (strings) to scalar coefficients. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">weighted_metrics</code> </td> <td> List of metrics to be evaluated and weighted by sample_weight or class_weight during training and testing. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">run_eagerly</code> </td> <td> Bool. Defaults to <code translate="no" dir="ltr">False</code>. If <code translate="no" dir="ltr">True</code>, this <code translate="no" dir="ltr">Model</code>'s logic will not be wrapped in a <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. Recommended to leave this as <code translate="no" dir="ltr">None</code> unless your <code translate="no" dir="ltr">Model</code> cannot be run inside a <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps_per_execution</code> </td> <td> Int. Defaults to 1. The number of batches to run during each <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> call. Running multiple batches inside a single <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> call can greatly improve performance on TPUs or small models with a large Python overhead. At most, one full epoch will be run each execution. If a number larger than the size of the epoch is passed, the execution will be truncated to the size of the epoch. Note that if <code translate="no" dir="ltr">steps_per_execution</code> is set to <code translate="no" dir="ltr">N</code>, <a href="callbacks/callback#on_batch_begin"><code translate="no" dir="ltr">Callback.on_batch_begin</code></a> and <a href="callbacks/callback#on_batch_end"><code translate="no" dir="ltr">Callback.on_batch_end</code></a> methods will only be called every <code translate="no" dir="ltr">N</code> batches (i.e. before/after each <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> execution). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Arguments supported for backwards compatibility only. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of invalid arguments for <code translate="no" dir="ltr">optimizer</code>, <code translate="no" dir="ltr">loss</code> or <code translate="no" dir="ltr">metrics</code>. </td> </tr> </table> <h3 id="evaluate" data-text="evaluate"><code translate="no" dir="ltr">evaluate</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1250-L1410">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
evaluate(
    x=None, y=None, batch_size=None, verbose=1, sample_weight=None, steps=None,
    callbacks=None, max_queue_size=10, workers=1, use_multiprocessing=False,
    return_dict=False
)
</pre> <p>Returns the loss value &amp; metrics values for the model in test mode.</p> <p>Computation is done in batches (see the <code translate="no" dir="ltr">batch_size</code> arg.)</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs.</li> <li>A <a href="../data"><code translate="no" dir="ltr">tf.data</code></a> dataset. Should return a tuple of either <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>.</li> <li>A generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> returning <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>. A more detailed description of unpacking behavior for iterator types (Dataset, generator, Sequence) is given in the <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> section of <code translate="no" dir="ltr">Model.fit</code>. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). It should be consistent with <code translate="no" dir="ltr">x</code> (you cannot have Numpy inputs and tensor targets, or inversely). If <code translate="no" dir="ltr">x</code> is a dataset, generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance, <code translate="no" dir="ltr">y</code> should not be specified (since targets will be obtained from the iterator/dataset). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per batch of computation. If unspecified, <code translate="no" dir="ltr">batch_size</code> will default to 32. Do not specify the <code translate="no" dir="ltr">batch_size</code> if your data is in the form of a dataset, generators, or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">verbose</code> </td> <td> 0 or 1. Verbosity mode. 0 = silent, 1 = progress bar. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional Numpy array of weights for the test samples, used for weighting the loss function. You can either pass a flat (1D) Numpy array with the same length as the input samples (1:1 mapping between weights and samples), or in the case of temporal data, you can pass a 2D array with shape <code translate="no" dir="ltr">(samples, sequence_length)</code>, to apply a different weight to every timestep of every sample. This argument is not supported when <code translate="no" dir="ltr">x</code> is a dataset, instead pass sample weights as the third element of <code translate="no" dir="ltr">x</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Total number of steps (batches of samples) before declaring the evaluation round finished. Ignored with the default value of <code translate="no" dir="ltr">None</code>. If x is a <a href="../data"><code translate="no" dir="ltr">tf.data</code></a> dataset and <code translate="no" dir="ltr">steps</code> is None, 'evaluate' will run until the dataset is exhausted. This argument is not supported with array inputs. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">callbacks</code> </td> <td> List of <a href="callbacks/callback"><code translate="no" dir="ltr">keras.callbacks.Callback</code></a> instances. List of callbacks to apply during evaluation. See <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks">callbacks</a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">max_queue_size</code> </td> <td> Integer. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum size for the generator queue. If unspecified, <code translate="no" dir="ltr">max_queue_size</code> will default to 10. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">workers</code> </td> <td> Integer. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum number of processes to spin up when using process-based threading. If unspecified, <code translate="no" dir="ltr">workers</code> will default to 1. If 0, will execute the generator on the main thread. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">use_multiprocessing</code> </td> <td> Boolean. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. If <code translate="no" dir="ltr">True</code>, use process-based threading. If unspecified, <code translate="no" dir="ltr">use_multiprocessing</code> will default to <code translate="no" dir="ltr">False</code>. Note that because this implementation relies on multiprocessing, you should not pass non-picklable arguments to the generator as they can't be passed easily to children processes. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_dict</code> </td> <td> If <code translate="no" dir="ltr">True</code>, loss and metric results are returned as a dict, with each key being the name of the metric. If <code translate="no" dir="ltr">False</code>, they are returned as a list. </td> </tr> </table> <p>See the discussion of <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> for <a href="model#fit"><code translate="no" dir="ltr">Model.fit</code></a>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Scalar test loss (if the model has a single output and no metrics) or list of scalars (if the model has multiple outputs and/or metrics). The attribute <code translate="no" dir="ltr">model.metrics_names</code> will give you the display labels for the scalar outputs. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.evaluate</code> is wrapped in <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> in case of invalid arguments. </td> </tr> </table> <h3 id="evaluate_generator" data-text="evaluate_generator"><code translate="no" dir="ltr">evaluate_generator</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1863-L1889">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
evaluate_generator(
    generator, steps=None, callbacks=None, max_queue_size=10, workers=1,
    use_multiprocessing=False, verbose=0
)
</pre> <p>Evaluates the model on a data generator.</p> <h4 id="deprecated" data-text="DEPRECATED:">DEPRECATED:</h4> <p><a href="model#evaluate"><code translate="no" dir="ltr">Model.evaluate</code></a> now supports generators, so there is no longer any need to use this endpoint.</p> <h3 id="fit" data-text="fit"><code translate="no" dir="ltr">fit</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L822-L1155">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
fit(
    x=None, y=None, batch_size=None, epochs=1, verbose=1, callbacks=None,
    validation_split=0.0, validation_data=None, shuffle=True, class_weight=None,
    sample_weight=None, initial_epoch=0, steps_per_epoch=None,
    validation_steps=None, validation_batch_size=None, validation_freq=1,
    max_queue_size=10, workers=1, use_multiprocessing=False
)
</pre> <p>Trains the model for a fixed number of epochs (iterations on a dataset).</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs.</li> <li>A <a href="../data"><code translate="no" dir="ltr">tf.data</code></a> dataset. Should return a tuple of either <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>.</li> <li>A generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> returning <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>. A more detailed description of unpacking behavior for iterator types (Dataset, generator, Sequence) is given below. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). It should be consistent with <code translate="no" dir="ltr">x</code> (you cannot have Numpy inputs and tensor targets, or inversely). If <code translate="no" dir="ltr">x</code> is a dataset, generator, or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance, <code translate="no" dir="ltr">y</code> should not be specified (since targets will be obtained from <code translate="no" dir="ltr">x</code>). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per gradient update. If unspecified, <code translate="no" dir="ltr">batch_size</code> will default to 32. Do not specify the <code translate="no" dir="ltr">batch_size</code> if your data is in the form of datasets, generators, or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">epochs</code> </td> <td> Integer. Number of epochs to train the model. An epoch is an iteration over the entire <code translate="no" dir="ltr">x</code> and <code translate="no" dir="ltr">y</code> data provided. Note that in conjunction with <code translate="no" dir="ltr">initial_epoch</code>, <code translate="no" dir="ltr">epochs</code> is to be understood as "final epoch". The model is not trained for a number of iterations given by <code translate="no" dir="ltr">epochs</code>, but merely until the epoch of index <code translate="no" dir="ltr">epochs</code> is reached. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">verbose</code> </td> <td> 0, 1, or 2. Verbosity mode. 0 = silent, 1 = progress bar, 2 = one line per epoch. Note that the progress bar is not particularly useful when logged to a file, so verbose=2 is recommended when not running interactively (eg, in a production environment). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">callbacks</code> </td> <td> List of <a href="callbacks/callback"><code translate="no" dir="ltr">keras.callbacks.Callback</code></a> instances. List of callbacks to apply during training. See <a href="callbacks"><code translate="no" dir="ltr">tf.keras.callbacks</code></a>. Note <a href="callbacks/progbarlogger"><code translate="no" dir="ltr">tf.keras.callbacks.ProgbarLogger</code></a> and <a href="callbacks/history"><code translate="no" dir="ltr">tf.keras.callbacks.History</code></a> callbacks are created automatically and need not be passed into <code translate="no" dir="ltr">model.fit</code>. <a href="callbacks/progbarlogger"><code translate="no" dir="ltr">tf.keras.callbacks.ProgbarLogger</code></a> is created or not based on <code translate="no" dir="ltr">verbose</code> argument to <code translate="no" dir="ltr">model.fit</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_split</code> </td> <td> Float between 0 and 1. Fraction of the training data to be used as validation data. The model will set apart this fraction of the training data, will not train on it, and will evaluate the loss and any model metrics on this data at the end of each epoch. The validation data is selected from the last samples in the <code translate="no" dir="ltr">x</code> and <code translate="no" dir="ltr">y</code> data provided, before shuffling. This argument is not supported when <code translate="no" dir="ltr">x</code> is a dataset, generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_data</code> </td> <td> Data on which to evaluate the loss and any model metrics at the end of each epoch. The model will not be trained on this data. Thus, note the fact that the validation loss of data provided using <code translate="no" dir="ltr">validation_split</code> or <code translate="no" dir="ltr">validation_data</code> is not affected by regularization layers like noise and dropout. <code translate="no" dir="ltr">validation_data</code> will override <code translate="no" dir="ltr">validation_split</code>. <code translate="no" dir="ltr">validation_data</code> could be: <li>tuple <code translate="no" dir="ltr">(x_val, y_val)</code> of Numpy arrays or tensors</li> <li>tuple <code translate="no" dir="ltr">(x_val, y_val, val_sample_weights)</code> of Numpy arrays</li> <li>dataset For the first two cases, <code translate="no" dir="ltr">batch_size</code> must be provided. For the last case, <code translate="no" dir="ltr">validation_steps</code> could be provided. Note that <code translate="no" dir="ltr">validation_data</code> does not support all the data types that are supported in <code translate="no" dir="ltr">x</code>, eg, dict, generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a>. </li>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">shuffle</code> </td> <td> Boolean (whether to shuffle the training data before each epoch) or str (for 'batch'). This argument is ignored when <code translate="no" dir="ltr">x</code> is a generator. 'batch' is a special option for dealing with the limitations of HDF5 data; it shuffles in batch-sized chunks. Has no effect when <code translate="no" dir="ltr">steps_per_epoch</code> is not <code translate="no" dir="ltr">None</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">class_weight</code> </td> <td> Optional dictionary mapping class indices (integers) to a weight (float) value, used for weighting the loss function (during training only). This can be useful to tell the model to "pay more attention" to samples from an under-represented class. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional Numpy array of weights for the training samples, used for weighting the loss function (during training only). You can either pass a flat (1D) Numpy array with the same length as the input samples (1:1 mapping between weights and samples), or in the case of temporal data, you can pass a 2D array with shape <code translate="no" dir="ltr">(samples, sequence_length)</code>, to apply a different weight to every timestep of every sample. This argument is not supported when <code translate="no" dir="ltr">x</code> is a dataset, generator, or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance, instead provide the sample_weights as the third element of <code translate="no" dir="ltr">x</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">initial_epoch</code> </td> <td> Integer. Epoch at which to start training (useful for resuming a previous training run). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps_per_epoch</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Total number of steps (batches of samples) before declaring one epoch finished and starting the next epoch. When training with input tensors such as TensorFlow data tensors, the default <code translate="no" dir="ltr">None</code> is equal to the number of samples in your dataset divided by the batch size, or 1 if that cannot be determined. If x is a <a href="../data"><code translate="no" dir="ltr">tf.data</code></a> dataset, and 'steps_per_epoch' is None, the epoch will run until the input dataset is exhausted. When passing an infinitely repeating dataset, you must specify the <code translate="no" dir="ltr">steps_per_epoch</code> argument. This argument is not supported with array inputs. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_steps</code> </td> <td> Only relevant if <code translate="no" dir="ltr">validation_data</code> is provided and is a <a href="../data"><code translate="no" dir="ltr">tf.data</code></a> dataset. Total number of steps (batches of samples) to draw before stopping when performing validation at the end of every epoch. If 'validation_steps' is None, validation will run until the <code translate="no" dir="ltr">validation_data</code> dataset is exhausted. In the case of an infinitely repeated dataset, it will run into an infinite loop. If 'validation_steps' is specified and only part of the dataset will be consumed, the evaluation will start from the beginning of the dataset at each epoch. This ensures that the same validation samples are used every time. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per validation batch. If unspecified, will default to <code translate="no" dir="ltr">batch_size</code>. Do not specify the <code translate="no" dir="ltr">validation_batch_size</code> if your data is in the form of datasets, generators, or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_freq</code> </td> <td> Only relevant if validation data is provided. Integer or <code translate="no" dir="ltr">collections_abc.Container</code> instance (e.g. list, tuple, etc.). If an integer, specifies how many training epochs to run before a new validation run is performed, e.g. <code translate="no" dir="ltr">validation_freq=2</code> runs validation every 2 epochs. If a Container, specifies the epochs on which to run validation, e.g. <code translate="no" dir="ltr">validation_freq=[1, 2, 10]</code> runs validation at the end of the 1st, 2nd, and 10th epochs. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">max_queue_size</code> </td> <td> Integer. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum size for the generator queue. If unspecified, <code translate="no" dir="ltr">max_queue_size</code> will default to 10. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">workers</code> </td> <td> Integer. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum number of processes to spin up when using process-based threading. If unspecified, <code translate="no" dir="ltr">workers</code> will default to 1. If 0, will execute the generator on the main thread. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">use_multiprocessing</code> </td> <td> Boolean. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. If <code translate="no" dir="ltr">True</code>, use process-based threading. If unspecified, <code translate="no" dir="ltr">use_multiprocessing</code> will default to <code translate="no" dir="ltr">False</code>. Note that because this implementation relies on multiprocessing, you should not pass non-picklable arguments to the generator as they can't be passed easily to children processes. </td> </tr> </table> <p>Unpacking behavior for iterator-like inputs: A common pattern is to pass a tf.data.Dataset, generator, or tf.keras.utils.Sequence to the <code translate="no" dir="ltr">x</code> argument of fit, which will in fact yield not only features (x) but optionally targets (y) and sample weights. Keras requires that the output of such iterator-likes be unambiguous. The iterator should return a tuple of length 1, 2, or 3, where the optional second and third elements will be used for y and sample_weight respectively. Any other type provided will be wrapped in a length one tuple, effectively treating everything as 'x'. When yielding dicts, they should still adhere to the top-level tuple structure. e.g. <code translate="no" dir="ltr">({"x0": x0, "x1": x1}, y)</code>. Keras will not attempt to separate features, targets, and weights from the keys of a single dict. A notable unsupported data type is the namedtuple. The reason is that it behaves like both an ordered datatype (tuple) and a mapping datatype (dict). So given a namedtuple of the form: <code translate="no" dir="ltr">namedtuple("example_tuple", ["y", "x"])</code> it is ambiguous whether to reverse the order of the elements when interpreting the value. Even worse is a tuple of the form: <code translate="no" dir="ltr">namedtuple("other_tuple", ["x", "y", "z"])</code> where it is unclear if the tuple was intended to be unpacked into x, y, and sample_weight or passed through as a single element to <code translate="no" dir="ltr">x</code>. As a result the data processing code will simply raise a ValueError if it encounters a namedtuple. (Along with instructions to remedy the issue.)</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A <code translate="no" dir="ltr">History</code> object. Its <code translate="no" dir="ltr">History.history</code> attribute is a record of training loss values and metrics values at successive epochs, as well as validation loss values and validation metrics values (if applicable). </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> <ol> <li>If the model was never compiled or,</li> <li>If <code translate="no" dir="ltr">model.fit</code> is wrapped in <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. </li>
</ol>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of mismatch between the provided input data and what the model expects or when the input data is empty. </td> </tr> </table> <h3 id="fit_generator" data-text="fit_generator"><code translate="no" dir="ltr">fit_generator</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1823-L1861">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
fit_generator(
    generator, steps_per_epoch=None, epochs=1, verbose=1, callbacks=None,
    validation_data=None, validation_steps=None, validation_freq=1,
    class_weight=None, max_queue_size=10, workers=1, use_multiprocessing=False,
    shuffle=True, initial_epoch=0
)
</pre> <p>Fits the model on data yielded batch-by-batch by a Python generator.</p> <h4 id="deprecated_2" data-text="DEPRECATED:">DEPRECATED:</h4> <p><a href="model#fit"><code translate="no" dir="ltr">Model.fit</code></a> now supports generators, so there is no longer any need to use this endpoint.</p> <h3 id="get_layer" data-text="get_layer"><code translate="no" dir="ltr">get_layer</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L2390-L2424">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
get_layer(
    name=None, index=None
)
</pre> <p>Retrieves a layer based on either its name (unique) or index.</p> <p>If <code translate="no" dir="ltr">name</code> and <code translate="no" dir="ltr">index</code> are both provided, <code translate="no" dir="ltr">index</code> will take precedence. Indices are based on order of horizontal graph traversal (bottom-up).</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">name</code> </td> <td> String, name of layer. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">index</code> </td> <td> Integer, index of layer. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A layer instance. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of invalid layer name or index. </td> </tr> </table> <h3 id="load_weights" data-text="load_weights"><code translate="no" dir="ltr">load_weights</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L2132-L2234">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
load_weights(
    filepath, by_name=False, skip_mismatch=False, options=None
)
</pre> <p>Loads all layer weights, either from a TensorFlow or an HDF5 weight file.</p> <p>If <code translate="no" dir="ltr">by_name</code> is False weights are loaded based on the network's topology. This means the architecture should be the same as when the weights were saved. Note that layers that don't have weights are not taken into account in the topological ordering, so adding or removing layers is fine as long as they don't have weights.</p> <p>If <code translate="no" dir="ltr">by_name</code> is True, weights are loaded into layers only if they share the same name. This is useful for fine-tuning or transfer-learning models where some of the layers have changed.</p> <p>Only topological loading (<code translate="no" dir="ltr">by_name=False</code>) is supported when loading weights from the TensorFlow format. Note that topological loading differs slightly between TensorFlow and HDF5 formats for user-defined classes inheriting from <a href="model"><code translate="no" dir="ltr">tf.keras.Model</code></a>: HDF5 loads based on a flattened list of weights, while the TensorFlow format loads based on the object-local names of attributes to which layers are assigned in the <code translate="no" dir="ltr">Model</code>'s constructor.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filepath</code> </td> <td> String, path to the weights file to load. For weight files in TensorFlow format, this is the file prefix (the same as was passed to <code translate="no" dir="ltr">save_weights</code>). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">by_name</code> </td> <td> Boolean, whether to load weights by name or by topological order. Only topological loading is supported for weight files in TensorFlow format. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">skip_mismatch</code> </td> <td> Boolean, whether to skip loading of layers where there is a mismatch in the number of weights, or a mismatch in the shape of the weight (only valid when <code translate="no" dir="ltr">by_name=True</code>). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">options</code> </td> <td> Optional <a href="../train/checkpointoptions"><code translate="no" dir="ltr">tf.train.CheckpointOptions</code></a> object that specifies options for loading weights. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> When loading a weight file in TensorFlow format, returns the same status object as <a href="../train/checkpoint#restore"><code translate="no" dir="ltr">tf.train.Checkpoint.restore</code></a>. When graph building, restore ops are run automatically as soon as the network is built (on first call for user-defined classes inheriting from <code translate="no" dir="ltr">Model</code>, immediately if it is already built). <p>When loading weights in HDF5 format, returns <code translate="no" dir="ltr">None</code>. </p>
</td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ImportError</code> </td> <td> If h5py is not available and the weight file is in HDF5 format. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> If <code translate="no" dir="ltr">skip_mismatch</code> is set to <code translate="no" dir="ltr">True</code> when <code translate="no" dir="ltr">by_name</code> is <code translate="no" dir="ltr">False</code>. </td> </tr> </table> <h3 id="make_predict_function" data-text="make_predict_function"><code translate="no" dir="ltr">make_predict_function</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1436-L1500">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
make_predict_function()
</pre> <p>Creates a function that executes one step of inference.</p> <p>This method can be overridden to support custom inference logic. This method is called by <a href="model#predict"><code translate="no" dir="ltr">Model.predict</code></a> and <a href="model#predict_on_batch"><code translate="no" dir="ltr">Model.predict_on_batch</code></a>.</p> <p>Typically, this method directly controls <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../distribute/strategy"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings, and delegates the actual evaluation logic to <a href="model#predict_step"><code translate="no" dir="ltr">Model.predict_step</code></a>.</p> <p>This function is cached the first time <a href="model#predict"><code translate="no" dir="ltr">Model.predict</code></a> or <a href="model#predict_on_batch"><code translate="no" dir="ltr">Model.predict_on_batch</code></a> is called. The cache is cleared whenever <a href="model#compile"><code translate="no" dir="ltr">Model.compile</code></a> is called.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Function. The function created by this method should accept a <a href="../data/iterator"><code translate="no" dir="ltr">tf.data.Iterator</code></a>, and return the outputs of the <code translate="no" dir="ltr">Model</code>. </td> </tr> 
</table> <h3 id="make_test_function" data-text="make_test_function"><code translate="no" dir="ltr">make_test_function</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1191-L1248">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
make_test_function()
</pre> <p>Creates a function that executes one step of evaluation.</p> <p>This method can be overridden to support custom evaluation logic. This method is called by <a href="model#evaluate"><code translate="no" dir="ltr">Model.evaluate</code></a> and <a href="model#test_on_batch"><code translate="no" dir="ltr">Model.test_on_batch</code></a>.</p> <p>Typically, this method directly controls <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../distribute/strategy"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings, and delegates the actual evaluation logic to <a href="model#test_step"><code translate="no" dir="ltr">Model.test_step</code></a>.</p> <p>This function is cached the first time <a href="model#evaluate"><code translate="no" dir="ltr">Model.evaluate</code></a> or <a href="model#test_on_batch"><code translate="no" dir="ltr">Model.test_on_batch</code></a> is called. The cache is cleared whenever <a href="model#compile"><code translate="no" dir="ltr">Model.compile</code></a> is called.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Function. The function created by this method should accept a <a href="../data/iterator"><code translate="no" dir="ltr">tf.data.Iterator</code></a>, and return a <code translate="no" dir="ltr">dict</code> containing values that will be passed to <code translate="no" dir="ltr">tf.keras.Callbacks.on_test_batch_end</code>. </td> </tr> 
</table> <h3 id="make_train_function" data-text="make_train_function"><code translate="no" dir="ltr">make_train_function</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L761-L820">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
make_train_function()
</pre> <p>Creates a function that executes one step of training.</p> <p>This method can be overridden to support custom training logic. This method is called by <a href="model#fit"><code translate="no" dir="ltr">Model.fit</code></a> and <a href="model#train_on_batch"><code translate="no" dir="ltr">Model.train_on_batch</code></a>.</p> <p>Typically, this method directly controls <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../distribute/strategy"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings, and delegates the actual training logic to <a href="model#train_step"><code translate="no" dir="ltr">Model.train_step</code></a>.</p> <p>This function is cached the first time <a href="model#fit"><code translate="no" dir="ltr">Model.fit</code></a> or <a href="model#train_on_batch"><code translate="no" dir="ltr">Model.train_on_batch</code></a> is called. The cache is cleared whenever <a href="model#compile"><code translate="no" dir="ltr">Model.compile</code></a> is called.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Function. The function created by this method should accept a <a href="../data/iterator"><code translate="no" dir="ltr">tf.data.Iterator</code></a>, and return a <code translate="no" dir="ltr">dict</code> containing values that will be passed to <code translate="no" dir="ltr">tf.keras.Callbacks.on_train_batch_end</code>, such as <code translate="no" dir="ltr">{'loss': 0.2, 'accuracy': 0.7}</code>. </td> </tr> 
</table> <h3 id="predict" data-text="predict"><code translate="no" dir="ltr">predict</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1502-L1647">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
predict(
    x, batch_size=None, verbose=0, steps=None, callbacks=None, max_queue_size=10,
    workers=1, use_multiprocessing=False
)
</pre> <p>Generates output predictions for the input samples.</p> <p>Computation is done in batches. This method is designed for performance in large scale inputs. For small amount of inputs that fit in one batch, directly using <code translate="no" dir="ltr">__call__</code> is recommended for faster execution, e.g., <code translate="no" dir="ltr">model(x)</code>, or <code translate="no" dir="ltr">model(x, training=False)</code> if you have layers such as <a href="layers/batchnormalization"><code translate="no" dir="ltr">tf.keras.layers.BatchNormalization</code></a> that behaves differently during inference. Also, note the fact that test loss is not affected by regularization layers like noise and dropout.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input samples. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A <a href="../data"><code translate="no" dir="ltr">tf.data</code></a> dataset.</li> <li>A generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance. A more detailed description of unpacking behavior for iterator types (Dataset, generator, Sequence) is given in the <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> section of <code translate="no" dir="ltr">Model.fit</code>. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per batch. If unspecified, <code translate="no" dir="ltr">batch_size</code> will default to 32. Do not specify the <code translate="no" dir="ltr">batch_size</code> if your data is in the form of dataset, generators, or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">verbose</code> </td> <td> Verbosity mode, 0 or 1. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps</code> </td> <td> Total number of steps (batches of samples) before declaring the prediction round finished. Ignored with the default value of <code translate="no" dir="ltr">None</code>. If x is a <a href="../data"><code translate="no" dir="ltr">tf.data</code></a> dataset and <code translate="no" dir="ltr">steps</code> is None, <code translate="no" dir="ltr">predict</code> will run until the input dataset is exhausted. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">callbacks</code> </td> <td> List of <a href="callbacks/callback"><code translate="no" dir="ltr">keras.callbacks.Callback</code></a> instances. List of callbacks to apply during prediction. See <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks">callbacks</a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">max_queue_size</code> </td> <td> Integer. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum size for the generator queue. If unspecified, <code translate="no" dir="ltr">max_queue_size</code> will default to 10. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">workers</code> </td> <td> Integer. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum number of processes to spin up when using process-based threading. If unspecified, <code translate="no" dir="ltr">workers</code> will default to 1. If 0, will execute the generator on the main thread. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">use_multiprocessing</code> </td> <td> Boolean. Used for generator or <a href="utils/sequence"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. If <code translate="no" dir="ltr">True</code>, use process-based threading. If unspecified, <code translate="no" dir="ltr">use_multiprocessing</code> will default to <code translate="no" dir="ltr">False</code>. Note that because this implementation relies on multiprocessing, you should not pass non-picklable arguments to the generator as they can't be passed easily to children processes. </td> </tr> </table> <p>See the discussion of <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> for <a href="model#fit"><code translate="no" dir="ltr">Model.fit</code></a>. Note that Model.predict uses the same interpretation rules as <a href="model#fit"><code translate="no" dir="ltr">Model.fit</code></a> and <a href="model#evaluate"><code translate="no" dir="ltr">Model.evaluate</code></a>, so inputs must be unambiguous for all three methods.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Numpy array(s) of predictions. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.predict</code> is wrapped in <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of mismatch between the provided input data and the model's expectations, or in case a stateful model receives a number of samples that is not a multiple of the batch size. </td> </tr> </table> <h3 id="predict_generator" data-text="predict_generator"><code translate="no" dir="ltr">predict_generator</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1891-L1915">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
predict_generator(
    generator, steps=None, callbacks=None, max_queue_size=10, workers=1,
    use_multiprocessing=False, verbose=0
)
</pre> <p>Generates predictions for the input samples from a data generator.</p> <h4 id="deprecated_3" data-text="DEPRECATED:">DEPRECATED:</h4> <p><a href="model#predict"><code translate="no" dir="ltr">Model.predict</code></a> now supports generators, so there is no longer any need to use this endpoint.</p> <h3 id="predict_on_batch" data-text="predict_on_batch"><code translate="no" dir="ltr">predict_on_batch</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1799-L1821">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
predict_on_batch(
    x
)
</pre> <p>Returns predictions for a single batch of samples.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: - A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs). - A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs). </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Numpy array(s) of predictions. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.predict_on_batch</code> is wrapped in <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of mismatch between given number of inputs and expectations of the model. </td> </tr> </table> <h3 id="predict_step" data-text="predict_step"><code translate="no" dir="ltr">predict_step</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1412-L1434">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
predict_step(
    data
)
</pre> <p>The logic for one inference step.</p> <p>This method can be overridden to support custom inference logic. This method is called by <a href="model#make_predict_function"><code translate="no" dir="ltr">Model.make_predict_function</code></a>.</p> <p>This method should contain the mathematical logic for one step of inference. This typically includes the forward pass.</p> <p>Configuration details for <em>how</em> this logic is run (e.g. <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../distribute/strategy"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings), should be left to <a href="model#make_predict_function"><code translate="no" dir="ltr">Model.make_predict_function</code></a>, which can also be overridden.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> A nested structure of <code translate="no" dir="ltr">Tensor</code>s. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> The result of one inference step, typically the output of calling the <code translate="no" dir="ltr">Model</code> on data. </td> </tr> 
</table> <h3 id="reset_metrics" data-text="reset_metrics"><code translate="no" dir="ltr">reset_metrics</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1649-L1669">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
reset_metrics()
</pre> <p>Resets the state of all the metrics in the model.</p> <h4 id="examples" data-text="Examples:">Examples:</h4> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
inputs = tf.keras.layers.Input(shape=(3,))
outputs = tf.keras.layers.Dense(2)(inputs)
model = tf.keras.models.Model(inputs=inputs, outputs=outputs)
model.compile(optimizer="Adam", loss="mse", metrics=["mae"])
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
x = np.random.random((2, 3))
y = np.random.randint(0, 2, (2, 2))
_ = model.fit(x, y, verbose=0)
assert all(float(m.result()) for m in model.metrics)
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
model.reset_metrics()
assert all(float(m.result()) == 0 for m in model.metrics)
</pre> <h3 id="reset_states" data-text="reset_states"><code translate="no" dir="ltr">reset_states</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L2306-L2309">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
reset_states()
</pre> <h3 id="save" data-text="save"><code translate="no" dir="ltr">save</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1950-L2002">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
save(
    filepath, overwrite=True, include_optimizer=True, save_format=None,
    signatures=None, options=None, save_traces=True
)
</pre> <p>Saves the model to Tensorflow SavedModel or a single HDF5 file.</p> <p>Please see <a href="models/save_model"><code translate="no" dir="ltr">tf.keras.models.save_model</code></a> or the <a href="https://keras.io/guides/serialization_and_saving/">Serialization and Saving guide</a> for details.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filepath</code> </td> <td> String, PathLike, path to SavedModel or H5 file to save the model. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">overwrite</code> </td> <td> Whether to silently overwrite any existing file at the target location, or provide the user with a manual prompt. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">include_optimizer</code> </td> <td> If True, save optimizer's state together. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">save_format</code> </td> <td> Either <code translate="no" dir="ltr">'tf'</code> or <code translate="no" dir="ltr">'h5'</code>, indicating whether to save the model to Tensorflow SavedModel or HDF5. Defaults to 'tf' in TF 2.X, and 'h5' in TF 1.X. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">signatures</code> </td> <td> Signatures to save with the SavedModel. Applicable to the 'tf' format only. Please see the <code translate="no" dir="ltr">signatures</code> argument in <a href="../saved_model/save"><code translate="no" dir="ltr">tf.saved_model.save</code></a> for details. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">options</code> </td> <td> (only applies to SavedModel format) <a href="../saved_model/saveoptions"><code translate="no" dir="ltr">tf.saved_model.SaveOptions</code></a> object that specifies options for saving to SavedModel. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">save_traces</code> </td> <td> (only applies to SavedModel format) When enabled, the SavedModel will store the function traces for each layer. This can be disabled, so that only the configs of each layer are stored. Defaults to <code translate="no" dir="ltr">True</code>. Disabling this will decrease serialization time and reduce file size, but it requires that all custom layers/models implement a <code translate="no" dir="ltr">get_config()</code> method. </td> </tr> </table> <h4 id="example" data-text="Example:">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">from keras.models import load_model

model.save('my_model.h5')  # creates a HDF5 file 'my_model.h5'
del model  # deletes the existing model

# returns a compiled model
# identical to the previous one
model = load_model('my_model.h5')
</pre> <h3 id="save_weights" data-text="save_weights"><code translate="no" dir="ltr">save_weights</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L2004-L2130">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
save_weights(
    filepath, overwrite=True, save_format=None, options=None
)
</pre> <p>Saves all layer weights.</p> <p>Either saves in HDF5 or in TensorFlow format based on the <code translate="no" dir="ltr">save_format</code> argument.</p> <p>When saving in HDF5 format, the weight file has:</p> <ul> <li>
<code translate="no" dir="ltr">layer_names</code> (attribute), a list of strings (ordered names of model layers).</li> <li>For every layer, a <code translate="no" dir="ltr">group</code> named <code translate="no" dir="ltr">layer.name</code> <ul> <li>For every such layer group, a group attribute <code translate="no" dir="ltr">weight_names</code>, a list of strings (ordered names of weights tensor of the layer).</li> <li>For every weight in the layer, a dataset storing the weight value, named after the weight tensor.</li> </ul>
</li> </ul> <p>When saving in TensorFlow format, all objects referenced by the network are saved in the same format as <a href="../train/checkpoint"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a>, including any <code translate="no" dir="ltr">Layer</code> instances or <code translate="no" dir="ltr">Optimizer</code> instances assigned to object attributes. For networks constructed from inputs and outputs using <code translate="no" dir="ltr">tf.keras.Model(inputs, outputs)</code>, <code translate="no" dir="ltr">Layer</code> instances used by the network are tracked/saved automatically. For user-defined classes which inherit from <a href="model"><code translate="no" dir="ltr">tf.keras.Model</code></a>, <code translate="no" dir="ltr">Layer</code> instances must be assigned to object attributes, typically in the constructor. See the documentation of <a href="../train/checkpoint"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a> and <a href="model"><code translate="no" dir="ltr">tf.keras.Model</code></a> for details.</p> <p>While the formats are the same, do not mix <code translate="no" dir="ltr">save_weights</code> and <a href="../train/checkpoint"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a>. Checkpoints saved by <a href="model#save_weights"><code translate="no" dir="ltr">Model.save_weights</code></a> should be loaded using <a href="model#load_weights"><code translate="no" dir="ltr">Model.load_weights</code></a>. Checkpoints saved using <a href="../train/checkpoint#save"><code translate="no" dir="ltr">tf.train.Checkpoint.save</code></a> should be restored using the corresponding <a href="../train/checkpoint#restore"><code translate="no" dir="ltr">tf.train.Checkpoint.restore</code></a>. Prefer <a href="../train/checkpoint"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a> over <code translate="no" dir="ltr">save_weights</code> for training checkpoints.</p> <p>The TensorFlow format matches objects and variables by starting at a root object, <code translate="no" dir="ltr">self</code> for <code translate="no" dir="ltr">save_weights</code>, and greedily matching attribute names. For <a href="model#save"><code translate="no" dir="ltr">Model.save</code></a> this is the <code translate="no" dir="ltr">Model</code>, and for <a href="../train/checkpoint#save"><code translate="no" dir="ltr">Checkpoint.save</code></a> this is the <code translate="no" dir="ltr">Checkpoint</code> even if the <code translate="no" dir="ltr">Checkpoint</code> has a model attached. This means saving a <a href="model"><code translate="no" dir="ltr">tf.keras.Model</code></a> using <code translate="no" dir="ltr">save_weights</code> and loading into a <a href="../train/checkpoint"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a> with a <code translate="no" dir="ltr">Model</code> attached (or vice versa) will not match the <code translate="no" dir="ltr">Model</code>'s variables. See the <a href="https://www.tensorflow.org/guide/checkpoint">guide to training checkpoints</a> for details on the TensorFlow format.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filepath</code> </td> <td> String or PathLike, path to the file to save the weights to. When saving in TensorFlow format, this is the prefix used for checkpoint files (multiple files are generated). Note that the '.h5' suffix causes weights to be saved in HDF5 format. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">overwrite</code> </td> <td> Whether to silently overwrite any existing file at the target location, or provide the user with a manual prompt. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">save_format</code> </td> <td> Either 'tf' or 'h5'. A <code translate="no" dir="ltr">filepath</code> ending in '.h5' or '.keras' will default to HDF5 if <code translate="no" dir="ltr">save_format</code> is <code translate="no" dir="ltr">None</code>. Otherwise <code translate="no" dir="ltr">None</code> defaults to 'tf'. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">options</code> </td> <td> Optional <a href="../train/checkpointoptions"><code translate="no" dir="ltr">tf.train.CheckpointOptions</code></a> object that specifies options for saving weights. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ImportError</code> </td> <td> If h5py is not available when attempting to save in HDF5 format. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> For invalid/unknown format arguments. </td> </tr> </table> <h3 id="summary" data-text="summary"><code translate="no" dir="ltr">summary</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L2357-L2384">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
summary(
    line_length=None, positions=None, print_fn=None
)
</pre> <p>Prints a string summary of the network.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">line_length</code> </td> <td> Total length of printed lines (e.g. set this to adapt the display to different terminal window sizes). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">positions</code> </td> <td> Relative or absolute positions of log elements in each line. If not provided, defaults to <code translate="no" dir="ltr">[.33, .55, .67, 1.]</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">print_fn</code> </td> <td> Print function to use. Defaults to <code translate="no" dir="ltr">print</code>. It will be called on each line of the summary. You can set it to a custom function in order to capture the string summary. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> if <code translate="no" dir="ltr">summary()</code> is called before the model is built. </td> </tr> </table> <h3 id="test_on_batch" data-text="test_on_batch"><code translate="no" dir="ltr">test_on_batch</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1740-L1797">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
test_on_batch(
    x, y=None, sample_weight=None, reset_metrics=True, return_dict=False
)
</pre> <p>Test the model on a single batch of samples.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: - A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs). - A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs). <ul> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). It should be consistent with <code translate="no" dir="ltr">x</code> (you cannot have Numpy inputs and tensor targets, or inversely). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional array of the same length as x, containing weights to apply to the model's loss for each sample. In the case of temporal data, you can pass a 2D array with shape (samples, sequence_length), to apply a different weight to every timestep of every sample. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">reset_metrics</code> </td> <td> If <code translate="no" dir="ltr">True</code>, the metrics returned will be only for this batch. If <code translate="no" dir="ltr">False</code>, the metrics will be statefully accumulated across batches. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_dict</code> </td> <td> If <code translate="no" dir="ltr">True</code>, loss and metric results are returned as a dict, with each key being the name of the metric. If <code translate="no" dir="ltr">False</code>, they are returned as a list. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Scalar test loss (if the model has a single output and no metrics) or list of scalars (if the model has multiple outputs and/or metrics). The attribute <code translate="no" dir="ltr">model.metrics_names</code> will give you the display labels for the scalar outputs. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.test_on_batch</code> is wrapped in <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of invalid user-provided arguments. </td> </tr> </table> <h3 id="test_step" data-text="test_step"><code translate="no" dir="ltr">test_step</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1157-L1189">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
test_step(
    data
)
</pre> <p>The logic for one evaluation step.</p> <p>This method can be overridden to support custom evaluation logic. This method is called by <a href="model#make_test_function"><code translate="no" dir="ltr">Model.make_test_function</code></a>.</p> <p>This function should contain the mathematical logic for one step of evaluation. This typically includes the forward pass, loss calculation, and metrics updates.</p> <p>Configuration details for <em>how</em> this logic is run (e.g. <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../distribute/strategy"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings), should be left to <a href="model#make_test_function"><code translate="no" dir="ltr">Model.make_test_function</code></a>, which can also be overridden.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> A nested structure of <code translate="no" dir="ltr">Tensor</code>s. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A <code translate="no" dir="ltr">dict</code> containing values that will be passed to <a href="callbacks/callbacklist#on_train_batch_end"><code translate="no" dir="ltr">tf.keras.callbacks.CallbackList.on_train_batch_end</code></a>. Typically, the values of the <code translate="no" dir="ltr">Model</code>'s metrics are returned. </td> </tr> 
</table> <h3 id="to_json" data-text="to_json"><code translate="no" dir="ltr">to_json</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L2264-L2279">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
to_json(
    **kwargs
)
</pre> <p>Returns a JSON string containing the network configuration.</p> <p>To load a network from a JSON save file, use <a href="models/model_from_json"><code translate="no" dir="ltr">keras.models.model_from_json(json_string, custom_objects={})</code></a>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Additional keyword arguments to be passed to <code translate="no" dir="ltr">json.dumps()</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A JSON string. </td> </tr> 
</table> <h3 id="to_yaml" data-text="to_yaml"><code translate="no" dir="ltr">to_yaml</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L2281-L2304">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
to_yaml(
    **kwargs
)
</pre> <p>Returns a yaml string containing the network configuration.</p> <p>To load a network from a yaml save file, use <a href="models/model_from_yaml"><code translate="no" dir="ltr">keras.models.model_from_yaml(yaml_string, custom_objects={})</code></a>.</p> <p><code translate="no" dir="ltr">custom_objects</code> should be a dictionary mapping the names of custom losses / layers / etc to the corresponding functions / classes.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Additional keyword arguments to be passed to <code translate="no" dir="ltr">yaml.dump()</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A YAML string. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ImportError</code> </td> <td> if yaml module is not found. </td> </tr> </table> <h3 id="train_on_batch" data-text="train_on_batch"><code translate="no" dir="ltr">train_on_batch</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L1671-L1738">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
train_on_batch(
    x, y=None, sample_weight=None, class_weight=None, reset_metrics=True,
    return_dict=False
)
</pre> <p>Runs a single gradient update on a single batch of data.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). It should be consistent with <code translate="no" dir="ltr">x</code> (you cannot have Numpy inputs and tensor targets, or inversely). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional array of the same length as x, containing weights to apply to the model's loss for each sample. In the case of temporal data, you can pass a 2D array with shape (samples, sequence_length), to apply a different weight to every timestep of every sample. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">class_weight</code> </td> <td> Optional dictionary mapping class indices (integers) to a weight (float) to apply to the model's loss for the samples from this class during training. This can be useful to tell the model to "pay more attention" to samples from an under-represented class. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">reset_metrics</code> </td> <td> If <code translate="no" dir="ltr">True</code>, the metrics returned will be only for this batch. If <code translate="no" dir="ltr">False</code>, the metrics will be statefully accumulated across batches. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_dict</code> </td> <td> If <code translate="no" dir="ltr">True</code>, loss and metric results are returned as a dict, with each key being the name of the metric. If <code translate="no" dir="ltr">False</code>, they are returned as a list. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Scalar training loss (if the model has a single output and no metrics) or list of scalars (if the model has multiple outputs and/or metrics). The attribute <code translate="no" dir="ltr">model.metrics_names</code> will give you the display labels for the scalar outputs. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.train_on_batch</code> is wrapped in <a href="../function"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of invalid user-provided arguments. </td> </tr> </table> <h3 id="train_step" data-text="train_step"><code translate="no" dir="ltr">train_step</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/v2.4.0/tensorflow/python/keras/engine/training.py#L724-L759">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
train_step(
    data
)
</pre> <p>The logic for one training step.</p> <p>This method can be overridden to support custom training logic. This method is called by <a href="model#make_train_function"><code translate="no" dir="ltr">Model.make_train_function</code></a>.</p> <p>This method should contain the mathematical logic for one step of training. This typically includes the forward pass, loss calculation, backpropagation, and metric updates.</p> <p>Configuration details for <em>how</em> this logic is run (e.g. <a href="../function"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../distribute/strategy"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings), should be left to <a href="model#make_train_function"><code translate="no" dir="ltr">Model.make_train_function</code></a>, which can also be overridden.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> A nested structure of <code translate="no" dir="ltr">Tensor</code>s. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A <code translate="no" dir="ltr">dict</code> containing values that will be passed to <a href="callbacks/callbacklist#on_train_batch_end"><code translate="no" dir="ltr">tf.keras.callbacks.CallbackList.on_train_batch_end</code></a>. Typically, the values of the <code translate="no" dir="ltr">Model</code>'s metrics are returned. Example: <code translate="no" dir="ltr">{'loss': 0.2, 'accuracy': 0.7}</code>. </td> </tr> 
</table>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2020 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/versions/r2.4/api_docs/python/tf/keras/Model" class="_attribution-link">https://www.tensorflow.org/versions/r2.4/api_docs/python/tf/keras/Model</a>
  </p>
</div>
